<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sushruta - AI Health Assistant</title>
    <!-- Tailwind CSS and Inter font -->
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        html, body {
            height: 100%;
            overflow: hidden; /* Prevent scrolling on the body */
        }
        body {
            font-family: 'Inter', sans-serif;
            background-color: #FAF8F7; /* Warmer off-white */
            display: flex;
            align-items: center;
            justify-content: center;
        }
        /* Main container with refined shadow */
        .chat-container {
            position: relative;
            width: 100%;
            height: 100%;
            background-color: #ffffff;
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }

        /* Apply responsive styles for larger screens */
        @media (min-width: 640px) {
            .chat-container {
                max-width: 36rem; /* Wider for tablets */
                height: 90vh;
                max-height: 800px;
                border-radius: 1.5rem;
                box-shadow: 0 20px 40px rgba(0, 0, 0, 0.08);
            }
             body {
                padding: 1rem;
            }
        }

        @media (min-width: 1024px) {
            .chat-container {
                max-width: 48rem; /* Even wider for desktops */
            }
        }
        
        /* NEW: Header with a soothing gradient */
        .header {
            background: linear-gradient(135deg, #F9A826, #E67E22); /* Saffron to Carrot gradient */
            color: white;
            padding: 1rem 1.5rem;
            display: flex;
            flex-direction: column;
            align-items: center;
            text-align: center;
            position: relative;
            z-index: 10;
        }
        /* Custom scrollbar for the chat area */
        .chat-area::-webkit-scrollbar {
            width: 8px;
        }
        .chat-area::-webkit-scrollbar-thumb {
            background-color: #9ca3af;
            border-radius: 4px;
        }
        /* Language button active state */
        .lang-btn.active {
            background-color: rgba(255, 255, 255, 0.2);
            font-weight: 600;
        }
        .lang-btn {
             transition: background-color 0.2s ease-in-out;
        }
        /* Animation for messages appearing */
        .message-enter-active { animation: fadeIn 0.5s ease-out; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
        
        /* Custom typing indicator animation */
        @keyframes pulse-delay-0 { 0%, 80%, 100% { opacity: 0.2; } 40% { opacity: 1; } }
        @keyframes pulse-delay-1 { 0%, 80%, 100% { opacity: 0.2; } 40% { opacity: 1; } }
        @keyframes pulse-delay-2 { 0%, 80%, 100% { opacity: 0.2; } 40% { opacity: 1; } }
        .animate-pulse-delay-0 { animation: pulse-delay-0 1.5s infinite; }
        .animate-pulse-delay-1 { animation: pulse-delay-1 1.5s infinite 0.2s; }
        .animate-pulse-delay-2 { animation: pulse-delay-2 1.5s infinite 0.4s; }
        .typing-indicator { display: none; }
        .quick-btn {
            transition: all 0.2s ease-in-out;
            transform: translateY(0);
            border: 1px solid #d1d5db;
        }
        .quick-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 10px rgba(0,0,0,0.05);
            border-color: #F9A826; /* Saffron border on hover */
            color: #F9A826;
        }
        .voice-icon.listening {
            animation: pulse-red 1.5s infinite;
        }
        @keyframes pulse-red {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.2); }
        }
        /* Animation to highlight the voice button */
        @keyframes pulse-blue {
            0% { box-shadow: 0 0 0 0 rgba(249, 168, 38, 0.7); } /* Saffron glow */
            70% { box-shadow: 0 0 0 10px rgba(249, 168, 38, 0); }
            100% { box-shadow: 0 0 0 0 rgba(249, 168, 38, 0); }
        }
        .voice-btn-highlight {
            animation: pulse-blue 2s infinite;
        }

        /* Improved chat bubble styles */
        .user-message {
            background: linear-gradient(135deg, #F9A826, #E67E22); /* Saffron to Carrot gradient for user */
        }
        .bot-message {
            background-color: #FDFBF8; /* Creamy off-white for bot */
            border: 1px solid #F0EBE3;
        }
    </style>
</head>
<body class="bg-gray-100">

    <div class="chat-container">
        
        <!-- Medical Disclaimer Banner -->
        <div class="bg-red-600 text-white text-center text-xs py-1 px-4 font-medium flex-shrink-0">
            тЪая╕П Disclaimer: This is an AI tool and not a substitute for professional medical advice.
        </div>

        <!-- Header -->
        <header class="header flex-shrink-0">
            <h1 class="text-2xl sm:text-3xl font-bold tracking-tight mb-1">Sushruta</h1>
            <p class="text-xs sm:text-sm text-orange-100">Your AI Health Assistant</p>
            <div class="flex flex-col sm:flex-row justify-between items-center w-full mt-3 space-y-3 sm:space-y-0">
                <div class="flex space-x-4 text-xs">
                    <div class="flex flex-col items-center">
                        <span class="font-semibold text-white">92%</span>
                        <span class="text-orange-100 text-xxs">Accuracy</span>
                    </div>
                    <div class="flex flex-col items-center">
                        <span class="font-semibold text-white">8</span>
                        <span class="text-orange-100 text-xxs">Languages</span>
                    </div>
                    <div class="flex flex-col items-center">
                        <span class="font-semibold text-white">100K+</span>
                        <span class="text-orange-100 text-xxs">Users Helped</span>
                    </div>
                </div>
                <div class="flex flex-wrap justify-center gap-1">
                    <button class="lang-btn text-white px-2 py-1 text-xs rounded-full active" onclick="setLanguage('en')" id="lang-en">English</button>
                    <button class="lang-btn text-white px-2 py-1 text-xs rounded-full" onclick="setLanguage('hi')" id="lang-hi">рд╣рд┐рдВрджреА</button>
                    <button class="lang-btn text-white px-2 py-1 text-xs rounded-full" onclick="setLanguage('bn')" id="lang-bn">ржмрж╛ржВрж▓рж╛</button>
                    <button class="lang-btn text-white px-2 py-1 text-xs rounded-full" onclick="setLanguage('ta')" id="lang-ta">родрооро┐ро┤рпН</button>
                    <button class="lang-btn text-white px-2 py-1 text-xs rounded-full" onclick="setLanguage('od')" id="lang-od">рмУрмбрм╝рм┐рмЖ</button>
                </div>
            </div>
        </header>

        <!-- Quick Actions -->
        <div class="p-2 bg-white flex flex-wrap gap-2 justify-center border-b border-gray-200 sticky top-0 z-10 flex-shrink-0">
            <button class="quick-btn bg-white text-gray-600 text-xs font-semibold px-3 py-1.5 rounded-full" data-query="Symptoms of Fever">ЁЯМбя╕П Fever</button>
            <button class="quick-btn bg-white text-gray-600 text-xs font-semibold px-3 py-1.5 rounded-full" data-query="What is COVID-19?">ЁЯШ╖ COVID-19</button>
            <button class="quick-btn bg-white text-gray-600 text-xs font-semibold px-3 py-1.5 rounded-full" data-query="Child Vaccination Schedule">ЁЯТЙ Vaccination</button>
            <button class="quick-btn bg-white text-gray-600 text-xs font-semibold px-3 py-1.5 rounded-full" data-query="Remedies for Cough">ЁЯШд Cough</button>
            <button class="quick-btn bg-red-500 hover:bg-red-600 text-white text-xs font-semibold px-3 py-1.5 rounded-full border-red-500" data-query="Emergency medical help">ЁЯЪи Emergency</button>
            <button class="quick-btn bg-rose-500 hover:bg-rose-600 text-white text-xs font-semibold px-3 py-1.5 rounded-full border-rose-500" data-query="Women's Health">тЩАя╕П Women's Health</button>
        </div>

        <!-- Chat Area -->
        <main id="chatArea" class="chat-area flex-1 p-4 overflow-y-auto bg-white space-y-4">
            <!-- Initial Bot Message will be dynamically inserted here -->
            <div id="initialMessageContainer"></div>
            <!-- Typing Indicator with better animation -->
            <div id="typingIndicator" class="typing-indicator flex items-center space-x-1 p-3 bg-gray-100 rounded-xl shadow-sm w-fit">
                <div class="w-2 h-2 bg-gray-400 rounded-full animate-pulse-delay-0"></div>
                <div class="w-2 h-2 bg-gray-400 rounded-full animate-pulse-delay-1"></div>
                <div class="w-2 h-2 bg-gray-400 rounded-full animate-pulse-delay-2"></div>
            </div>
        </main>
        
        <!-- Input Area -->
        <footer class="bg-white p-2 border-t border-gray-200 flex items-center space-x-2 relative flex-shrink-0">
            <!-- NEW: Tooltip for Voice Feature -->
            <div id="voice-tooltip" class="hidden absolute -top-12 left-2 bg-gray-800 text-white text-xs rounded-md px-3 py-2 shadow-lg z-20 transition-opacity duration-300 opacity-0">
                <span id="tooltip-text"></span>
                <button id="close-tooltip" class="ml-2 font-bold text-lg leading-none">&times;</button>
            </div>
            <!-- Voice Input Button -->
            <button id="voiceBtn" class="bg-green-800 hover:bg-green-900 text-white p-2 rounded-full shadow-lg transition-all transform hover:scale-105 flex-shrink-0">
                <svg id="mic-icon" xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                    <path stroke-linecap="round" stroke-linejoin="round" d="M19 11a7 7 0 01-7 7v0a7 7 0 01-7-7v0a7 7 0 017-7v0a7 7 0 017 7z" />
                    <path stroke-linecap="round" stroke-linejoin="round" d="M12 21v-4m-4 4h8" />
                </svg>
            </button>
            <input type="text" id="messageInput" placeholder="Ask a health question..." class="flex-1 px-4 py-2 bg-gray-100 rounded-full text-sm border-2 border-transparent focus:outline-none focus:border-orange-500 transition-all" onkeypress="handleKeyPress(event)">
            <button id="sendBtn" class="bg-green-800 hover:bg-green-900 text-white font-semibold px-4 py-2 rounded-full shadow-lg transition-all transform hover:scale-105 flex-shrink-0">Send</button>
        </footer>
        <!-- Virtual Keyboard Toggle for Mobile -->
        <button id="keyboardBtn" class="sm:hidden fixed bottom-16 right-4 bg-gray-200 hover:bg-gray-300 text-gray-800 p-3 rounded-full shadow-lg transition-all transform hover:scale-105 z-20">
            <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                <path stroke-linecap="round" stroke-linejoin="round" d="M9.75 17L9 20l-1 1h8l-1-1-.75-3M3 13h18M5 17h14a2 2 0 002-2V5a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z" />
            </svg>
        </button>
        <!-- Virtual Keyboard -->
        <div id="virtualKeyboard" class="bg-gray-200 p-2 border-t border-gray-200 hidden flex-shrink-0">
            <div id="keyboardLayout" class="grid gap-1"></div>
        </div>
    </div>
    
    <!-- New: Searching Overlay/Modal -->
    <div id="searchingOverlay" class="fixed inset-0 bg-gray-800 bg-opacity-70 flex items-center justify-center z-50 hidden">
        <div class="bg-white rounded-xl shadow-lg p-6 text-center max-w-sm w-full animate-pulse mx-4">
            <p class="text-lg font-semibold text-gray-800" id="searchingMessage"></p>
        </div>
    </div>

    <script>
        // This variable should be replaced with a valid API key for the generative features to work.
        // It's intentionally left blank here for security reasons.
        const apiKey = "AIzaSyDY4WUNKFyJmTDKZFCi0xZjLZvoMxsNTNo";
        const API_MODEL = "gemini-2.5-flash-preview-05-20";
        const API_URL = `https://generativelanguage.googleapis.com/v1beta/models/${API_MODEL}:generateContent?key=${apiKey}`;

        // Chat history and current language state
        let chatHistory = [{
            role: "user",
            parts: [{ text: "Start a health-related conversation with a person and respond in the user's preferred language." }],
        }];
        let currentLanguage = 'en';

        // Get DOM elements
        const chatArea = document.getElementById('chatArea');
        const messageInput = document.getElementById('messageInput');
        const sendBtn = document.getElementById('sendBtn');
        const searchingOverlay = document.getElementById('searchingOverlay');
        const searchingMessage = document.getElementById('searchingMessage');
        const voiceBtn = document.getElementById('voiceBtn');
        const keyboardBtn = document.getElementById('keyboardBtn');
        const virtualKeyboard = document.getElementById('virtualKeyboard');
        const keyboardLayout = document.getElementById('keyboardLayout');
        const micIcon = document.getElementById('mic-icon');
        const initialMessageContainer = document.getElementById('initialMessageContainer');
        // NEW: Tooltip elements
        const voiceTooltip = document.getElementById('voice-tooltip');
        const tooltipText = document.getElementById('tooltip-text');
        const closeTooltipBtn = document.getElementById('close-tooltip');


            // NEW: Centralized translations for UI text
        const translations = {
            en: {
                initialMessage: `<div class="message bot-message p-4 rounded-xl max-w-lg animate-slideIn">
                    <p class="font-bold text-gray-800">Hi, I'm Sushruta, your friendly AI Health Assistant! ЁЯй║</p>
                    <p class="text-sm text-gray-600 mt-1">I can help with disease symptoms, vaccination schedules, and more. ЁЯШК</p>
                    <p class="text-xs text-gray-400 mt-3 italic">Please ask your question or use the buttons above.</p>
                </div>`,
                placeholder: "Type your health question...",
                searching: "Searching for a solution... ЁЯФН",
                languageChanged: "тЬЕ Language changed to English.",
                voiceTooltip: "New! Tap the mic to ask with your voice."
            },
            hi: {
                initialMessage: `<div class="message bot-message p-4 rounded-xl max-w-lg animate-slideIn">
                    <p class="font-bold text-gray-800">рдирдорд╕реНрддреЗ, рдореИрдВ рд╕реБрд╢реНрд░реБрдд рд╣реВрдБ, рдЖрдкрдХрд╛ рдПрдЖрдИ рд╕реНрд╡рд╛рд╕реНрдереНрдп рд╕рд╣рд╛рдпрдХ! ЁЯй║</p>
                    <p class="text-sm text-gray-600 mt-1">рдореИрдВ рдЖрдкрдХреА рдорджрдж рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдпрд╣рд╛рдБ рд╣реВрдБ! ЁЯШК</p>
                    <p class="text-xs text-gray-400 mt-3 italic">рдХреГрдкрдпрд╛ рдЕрдкрдирд╛ рдкреНрд░рд╢реНрди рдкреВрдЫреЗрдВ рдпрд╛ рдКрдкрд░ рджрд┐рдП рдЧрдП рдмрдЯрдиреЛрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВред</p>
                </div>`,
                placeholder: "рдЕрдкрдирд╛ рд╕реНрд╡рд╛рд╕реНрдереНрдп рдкреНрд░рд╢реНрди рдпрд╣рд╛рдБ рд▓рд┐рдЦреЗрдВ...",
                searching: "рд╕рдорд╛рдзрд╛рди рдЦреЛрдЬрд╛ рдЬрд╛ рд░рд╣рд╛ рд╣реИ... ЁЯФН",
                languageChanged: "тЬЕ рднрд╛рд╖рд╛ рд╣рд┐рдВрджреА рдореЗрдВ рдмрджрд▓реА рдЧрдИред",
                voiceTooltip: "рдирдпрд╛! рдЕрдкрдиреА рдЖрд╡рд╛рдЬ рд╕реЗ рд╕рд╡рд╛рд▓ рдкреВрдЫрдиреЗ рдХреЗ рд▓рд┐рдП рдЯреИрдк рдХрд░реЗрдВред"
            },
             bn: {
                initialMessage: `<div class="message bot-message p-4 rounded-xl max-w-lg animate-slideIn">
                    <p class="font-bold text-gray-800">ржиржорж╕рзНржХрж╛рж░, ржЖржорж┐ рж╕рзБрж╢рзНрж░рзБржд, ржЖржкржирж╛рж░ ржПржЖржЗ рж╕рзНржмрж╛рж╕рзНржерзНржп рж╕рж╣ржХрж╛рж░рзА! ЁЯй║</p>
                    <p class="text-sm text-gray-600 mt-1">ржЖржорж┐ ржЖржкржирж╛ржХрзЗ рж╕рж╛рж╣рж╛ржпрзНржп ржХрж░рж╛рж░ ржЬржирзНржп ржПржЦрж╛ржирзЗ ржЖржЫрж┐! ЁЯШК</p>
                    <p class="text-xs text-gray-400 mt-3 italic">ржЕржирзБржЧрзНрж░рж╣ ржХрж░рзЗ ржЖржкржирж╛рж░ ржкрзНрж░рж╢рзНржи ржЬрж┐ржЬрзНржЮрж╛рж╕рж╛ ржХрж░рзБржи ржмрж╛ ржЙржкрж░рзЗрж░ ржмрзЛрждрж╛ржоржЧрзБрж▓рж┐ ржмрзНржпржмрж╣рж╛рж░ ржХрж░рзБржиред</p>
                </div>`,
                placeholder: "ржЖржкржирж╛рж░ рж╕рзНржмрж╛рж╕рзНржерзНржп ржкрзНрж░рж╢рзНржи ржПржЦрж╛ржирзЗ ржЯрж╛ржЗржк ржХрж░рзБржи...",
                searching: "рж╕ржорж╛ржзрж╛ржи ржЦрзЛржБржЬрж╛ рж╣ржЪрзНржЫрзЗ... ЁЯФН",
                languageChanged: "тЬЕ ржнрж╛рж╖рж╛ ржмрж╛ржВрж▓рж╛ржпрж╝ ржкрж░рж┐ржмрж░рзНрждржи ржХрж░рж╛ рж╣ржпрж╝рзЗржЫрзЗред",
                voiceTooltip: "ржирждрзБржи! ржЖржкржирж╛рж░ ржнржпрж╝рзЗрж╕ ржжрж┐ржпрж╝рзЗ ржкрзНрж░рж╢рзНржи ржХрж░рждрзЗ ржЯрзНржпрж╛ржк ржХрж░рзБржиред"
            },
            ta: {
                initialMessage: `<div class="message bot-message p-4 rounded-xl max-w-lg animate-slideIn">
                    <p class="font-bold text-gray-800">ро╡рогроХрпНроХроорпН, роиро╛ройрпН роЪрпБро╖рпНро░рпБродро╛, роЙроЩрпНроХро│рпН AI роЪрпБроХро╛родро╛ро░ роЙродро╡ро┐ропро╛ро│ро░рпН! ЁЯй║</p>
                    <p class="text-sm text-gray-600 mt-1">роЙроЩрпНроХро│рпБроХрпНроХрпБ роЙродро╡ роиро╛ройрпН роЗроЩрпНроХрпЗ роЗро░рпБроХрпНроХро┐ро▒рпЗройрпН! ЁЯШК</p>
                    <p class="text-xs text-gray-400 mt-3 italic">роЙроЩрпНроХро│рпН роХрпЗро│рпНро╡ро┐ропрпИроХрпН роХрпЗроЯрпНроХро╡рпБроорпН роЕро▓рпНро▓родрпБ роорпЗро▓рпЗ роЙро│рпНро│ рокрпКродрпНродро╛ройрпНроХро│рпИрокрпН рокропройрпНрокроЯрпБродрпНродро╡рпБроорпН.</p>
                </div>`,
                placeholder: "роЙроЩрпНроХро│рпН роЪрпБроХро╛родро╛ро░ роХрпЗро│рпНро╡ро┐ропрпИ роЗроЩрпНроХрпЗ родроЯрпНроЯроЪрпНроЪрпБ...",
                searching: "родрпАро░рпНро╡рпБ родрпЗроЯрокрпНрокроЯрпБроХро┐ро▒родрпБ... ЁЯФН",
                languageChanged: "тЬЕ роорпКро┤ро┐ родрооро┐ро┤рпБроХрпНроХрпБ рооро╛ро▒рпНро▒рокрпНрокроЯрпНроЯрпБро│рпНро│родрпБред",
                voiceTooltip: "рокрпБродро┐ропродрпБ! роЙроЩрпНроХро│рпН роХрпБро░ро▓ро┐ро▓рпН роХрпЗроЯрпНроХ родроЯрпНроЯро╡рпБроорпН."
            },
            od: {
                initialMessage: `<div class="message bot-message p-4 rounded-xl max-w-lg animate-slideIn">
                    <p class="font-bold text-gray-800">рмирморм╕рнНрмХрм╛рм░, рморнБрмБ рм╕рнБрм╢рнНрм░рнБрмд, рмЖрмкрмгрмЩрнНрмХ рмПрмЖрмЗ рм╕рнНрн▒рм╛рм╕рнНрмернНрнЯ рм╕рм╣рм╛рнЯрмХ! ЁЯй║</p>
                    <p class="text-sm text-gray-600 mt-1">рморнБрмБ рмЖрмкрмгрмЩрнНрмХрнБ рм╕рм╛рм╣рм╛рмпрнНрнЯ рмХрм░рм┐рммрм╛ рмкрм╛рмЗрмБ рмПрмарм╛рм░рнЗ рмЕрмЫрм┐! ЁЯШК</p>
                    <p class="text-xs text-gray-400 mt-3 italic">рмжрнЯрм╛рмХрм░рм┐ рмЖрмкрмгрмЩрнНрмХрм░ рмкрнНрм░рм╢рнНрми рмкрмЪрм╛рм░рмирнНрмдрнБ рмХрм┐рморнНрммрм╛ рмЙрмкрм░ рммрмЯрмирнН рммрнНрнЯрммрм╣рм╛рм░ рмХрм░рмирнНрмдрнБред</p>
                </div>`,
                placeholder: "рмЖрмкрмгрмЩрнНрмХ рм╕рнНрн▒рм╛рм╕рнНрмернНрнЯ рмкрнНрм░рм╢рнНрми рмПрмарм╛рм░рнЗ рмЯрм╛рмЗрмкрнН рмХрм░рмирнНрмдрнБ...",
                searching: "рм╕рморм╛рмзрм╛рми рмЦрнЛрмЬрм╛рмпрм╛рмЙрмЫрм┐... ЁЯФН",
                languageChanged: "тЬЕ рмнрм╛рм╖рм╛ рмУрмбрм╝рм┐рмЖрмХрнБ рммрмжрм│рм╛рмЧрм▓рм╛ред",
                voiceTooltip: "рмирнВрмЖ! рмЖрмкрмгрмЩрнНрмХ рм╕рнНрн▒рм░рм░рнЗ рмкрмЪрм╛рм░рм┐рммрм╛ рмкрм╛рмЗрмБ рмЯрнНрнЯрм╛рмкрнН рмХрм░рмирнНрмдрнБред"
            }
        };


        // Pre-programmed knowledge base for quick-action buttons and specific queries
        const knowledgeBase = {
            womensHealth: {
                en: {
                    response: `ЁЯСйтАНтЪХя╕П <strong>Women's Health:</strong><br><br>
                    <div class="bg-pink-100 text-pink-800 p-4 rounded-lg my-2">
                        <strong class="font-semibold">Common topics:</strong><br>
                        <ul><li><strong>Menstrual Health:</strong> Irregular periods, heavy bleeding, or severe pain should be discussed with a doctor.</li>
                        <li><strong>PCOS:</strong> Polycystic Ovary Syndrome symptoms include irregular periods, excess hair growth, and weight gain.</li>
                        <li><strong>UTIs:</strong> Urinary Tract Infections are common; symptoms include painful urination and frequent urges.</li></ul>
                        <br><br>
                        <strong class="font-semibold text-red-600">тЪая╕П Disclaimer:</strong> For a proper diagnosis and treatment plan, it is crucial to consult a Gynecologist or a General Physician.
                    </div>`,
                    keywords: ['women\'s health', 'women', 'menstrual', 'pcos', 'uti', 'female health']
                },
                hi: {
                    response: `ЁЯСйтАНтЪХя╕П <strong>рдорд╣рд┐рд▓рд╛ рд╕реНрд╡рд╛рд╕реНрдереНрдп:</strong><br><br>
                    <div class="bg-pink-100 text-pink-800 p-4 rounded-lg my-2">
                        <strong class="font-semibold">рд╕рд╛рдорд╛рдиреНрдп рд╡рд┐рд╖рдп:</strong><br>
                        <ul><li><strong>рдорд╛рд╕рд┐рдХ рдзрд░реНрдо рд╕реНрд╡рд╛рд╕реНрдереНрдп:</strong> рдЕрдирд┐рдпрдорд┐рдд рдкреАрд░рд┐рдпрдбреНрд╕, рдЬреНрдпрд╛рджрд╛ рдмреНрд▓реАрдбрд┐рдВрдЧ, рдпрд╛ рддреЗрдЬ рджрд░реНрдж рд╣реЛрдиреЗ рдкрд░ рдбреЙрдХреНрдЯрд░ рд╕реЗ рд╕рд▓рд╛рд╣ рд▓реЗрдВред</li>
                        <li><strong>PCOS:</strong> рдкреЙрд▓реАрд╕рд┐рд╕реНрдЯрд┐рдХ рдУрд╡рд░реА рд╕рд┐рдВрдбреНрд░реЛрдо рдХреЗ рд▓рдХреНрд╖рдгреЛрдВ рдореЗрдВ рдЕрдирд┐рдпрдорд┐рдд рдкреАрд░рд┐рдпрдбреНрд╕, рдЕрддрд┐рд░рд┐рдХреНрдд рдмрд╛рд▓ рдЙрдЧрдирд╛ рдФрд░ рд╡рдЬрди рдмрдврд╝рдирд╛ рд╢рд╛рдорд┐рд▓ рд╣реИред</li>
                        <li><strong>UTIs:</strong> рдпреВрд░рд┐рдирд░реА рдЯреНрд░реИрдХреНрдЯ рдЗрдиреНрдлреЗрдХреНрд╢рди рдЖрдо рд╣реИрдВ; рд▓рдХреНрд╖рдгреЛрдВ рдореЗрдВ рдкреЗрд╢рд╛рдм рдХрд░рддреЗ рд╕рдордп рджрд░реНрдж рдФрд░ рдмрд╛рд░-рдмрд╛рд░ рдкреЗрд╢рд╛рдм рдХрд╛ рдЖрдЧреНрд░рд╣ рд╢рд╛рдорд┐рд▓ рд╣реИред</li></ul>
                        <br><br>
                        <strong class="font-semibold text-red-600">тЪая╕П рдЪреЗрддрд╛рд╡рдиреА:</strong> рд╕рдЯреАрдХ рдирд┐рджрд╛рди рдФрд░ рдЙрдкрдЪрд╛рд░ рдпреЛрдЬрдирд╛ рдХреЗ рд▓рд┐рдП, рд╕реНрддреНрд░реА рд░реЛрдЧ рд╡рд┐рд╢реЗрд╖рдЬреНрдЮ рдпрд╛ рд╕рд╛рдорд╛рдиреНрдп рдЪрд┐рдХрд┐рддреНрд╕рдХ рд╕реЗ рдкрд░рд╛рдорд░реНрд╢ рдХрд░рдирд╛ рдорд╣рддреНрд╡рдкреВрд░реНрдг рд╣реИред
                    </div>`,
                    keywords: ['рдорд╣рд┐рд▓рд╛ рд╕реНрд╡рд╛рд╕реНрдереНрдп', 'рдорд╣рд┐рд▓рд╛', 'рдорд╛рд╕рд┐рдХ рдзрд░реНрдо', 'рдкреЙрд▓реАрд╕рд┐рд╕реНрдЯрд┐рдХ', 'рдкреА.рд╕реА.рдУ.рдПрд╕.', 'рдпреВрдЯреАрдЖрдИ']
                },
                od: {
                    response: `ЁЯСйтАНтЪХя╕П <strong>рморм╣рм┐рм│рм╛рмЩрнНрмХ рм╕рнНрн▒рм╛рм╕рнНрмернНрнЯ:</strong><br><br>
                    <div class="bg-pink-100 text-pink-800 p-4 rounded-lg my-2">
                        <strong class="font-semibold">рм╕рм╛рмзрм╛рм░рмг рммрм┐рм╖рнЯ:</strong><br>
                        <ul><li><strong>рморм╛рм╕рм┐рмХ рмзрм░рнНрмо рм╕рнНрн▒рм╛рм╕рнНрмернНрнЯ:</strong> рмЕрмирм┐рнЯрморм┐рмд рмкрм┐рм░рм┐рмЕрмбрнН, рмЕрмзрм┐рмХ рм░рмХрнНрмдрм╕рнНрм░рм╛рмм, рмХрм┐рморнНрммрм╛ рмЧрнБрм░рнБрмдрм░ рмпрмирнНрмдрнНрм░рмгрм╛ рм╣рнЗрм▓рнЗ рмбрм╛рмХрнНрмдрм░рмЩрнНрмХ рм╕рм╣рм┐рмд рмкрм░рм╛рморм░рнНрм╢ рмХрм░рм┐рммрм╛ рмЙрмЪрм┐рмдрнНред</li>
                        <li><strong>PCOS:</strong> рмкрм▓рм┐рм╕рм┐рм╖рнНрмЯрм┐рмХрнН рмУрмнрм╛рм░рнА рм╕рм┐рмгрнНрмбрнНрм░рнЛрморм░ рм▓рмХрнНрм╖рмгрмЧрнБрмбрм╝рм┐рмХрм░рнЗ рмЕрмирм┐рнЯрморм┐рмд рмкрм┐рм░рм┐рмЕрмбрнН, рмЕрмдрнНрнЯрмзрм┐рмХ рмХрнЗрм╢ рммрнГрмжрнНрмзрм┐ рмПрммрмВ рмУрмЬрми рммрнГрмжрнНрмзрм┐ рм╕рм╛рморм┐рм▓рнНред</li>
                        <li><strong>UTIs:</strong> рморнВрмдрнНрм░рм╛рм╢рнЯ рм╕рмВрмХрнНрм░рмормг рм╕рм╛рмзрм╛рм░рмг рмЕрмЯрнЗ; рм▓рмХрнНрм╖рмгрмЧрнБрмбрм╝рм┐рмХрм░рнЗ рмпрмирнНрмдрнНрм░рмгрм╛рмжрм╛рнЯрмХ рморнВрмдрнНрм░рмдрнНрнЯрм╛рмЧ рмПрммрмВ рммрм╛рм░рморнНрммрм╛рм░ рморнВрмдрнНрм░рмдрнНрнЯрм╛рмЧ рмХрм░рм┐рммрм╛рм░ рмЗрмЪрнНрмЫрм╛ рмЕрмирнНрмдрм░рнНрмнрнБрмХрнНрмдред</li></ul>
                        <br><br>
                        <strong class="font-semibold text-red-600">тЪая╕П рм╕рмдрм░рнНрмХрмдрм╛:</strong> рм╕рмарм┐рмХрнН рм░рнЛрмЧ рмирм┐рм░рнНрмгрнНрмгрнЯ рмПрммрмВ рмЪрм┐рмХрм┐рмдрнНрм╕рм╛ рмкрм╛рмЗрмБ, рмЬрмгрнЗ рм╕рнНрмдрнНрм░рнА рм░рнЛрмЧ рммрм┐рм╢рнЗрм╖рмЬрнНрмЮ рмХрм┐рморнНрммрм╛ рмЬрмгрнЗ рм╕рм╛рмзрм╛рм░рмг рмЪрм┐рмХрм┐рмдрнНрм╕рмХрмЩрнНрмХ рм╕рм╣рм┐рмд рмкрм░рм╛рморм░рнНрм╢ рмХрм░рм┐рммрм╛ рмЕрмдрнНрнЯрмирнНрмд рмЧрнБрм░рнБрмдрнНрн▒рмкрнВрм░рнНрмгрнНрмгред
                    </div>`,
                    keywords: ['рморм╣рм┐рм│рм╛ рм╕рнНрн▒рм╛рм╕рнНрмернНрнЯ', 'рморм╣рм┐рм│рм╛', 'рморм╛рм╕рм┐рмХ рмзрм░рнНрмо', 'рмкрм┐.рм╕рм┐.рмУ.рмПрм╕', 'рнЯрнБ.рмЯрм┐.рмЖрмЗ']
                }
            },
            diseaseOutbreaks: {
                en: { keywords: ['disease outbreaks', 'outbreak', 'alerts', 'advisory', 'disease', 'diseases'] },
                hi: { keywords: ['рд░реЛрдЧ рдкреНрд░рдХреЛрдк', 'рдкреНрд░рдХреЛрдк', 'рдЕрд▓рд░реНрдЯ', 'рд╕рд▓рд╛рд╣', 'рд░реЛрдЧ', 'рдмреАрдорд╛рд░реА'] },
                od: { keywords: ['рм░рнЛрмЧ рмкрнНрм░рмХрнЛрмк', 'рмкрнНрм░рмХрнЛрмк', 'рм╕рмдрм░рнНрмХрмдрм╛', 'рм░рнЛрмЧ'] }
            },
            govtHospitals: {
                en: {
                    response: `ЁЯПе <strong>Government Hospitals in India:</strong><br><br>
                    <div class="bg-cyan-100 text-cyan-800 p-4 rounded-lg my-2">
                        <p>Finding a government hospital is a great way to access affordable healthcare. Don't worry, we can help you with that! ЁЯШК</p>
                        <br>
                        <p>To give you the most accurate list, please tell me which city you are looking for hospitals in. For example, you can type "<strong>Government hospitals in Noida</strong>".</p>
                    </div>`,
                    keywords: ['government hospital', 'govt hospital', 'sarkari hospital', 'government clinic', 'рд╕рд░рдХрд╛рд░реА рдЕрд╕реНрдкрддрд╛рд▓', 'рд╕рд░рдХрд╛рд░реА рдХреНрд▓рд┐рдирд┐рдХ']
                },
                hi: {
                    response: `ЁЯПе <strong>рднрд╛рд░рдд рдореЗрдВ рд╕рд░рдХрд╛рд░реА рдЕрд╕реНрдкрддрд╛рд▓:</strong><br><br>
                    <div class="bg-cyan-100 text-cyan-800 p-4 rounded-lg my-2">
                        <p>рд╕рд░рдХрд╛рд░реА рдЕрд╕реНрдкрддрд╛рд▓ рдвреВрдВрдврдирд╛ рдХрд┐рдлрд╛рдпрддреА рд╕реНрд╡рд╛рд╕реНрдереНрдп рд╕реЗрд╡рд╛ рдкрд╛рдиреЗ рдХрд╛ рдПрдХ рд╢рд╛рдирджрд╛рд░ рддрд░реАрдХрд╛ рд╣реИред рдЪрд┐рдВрддрд╛ рди рдХрд░реЗрдВ, рд╣рдо рдЗрд╕рдореЗрдВ рдЖрдкрдХреА рдорджрдж рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ! ЁЯШК</p>
                        <br>
                        <p>рд╕рдмрд╕реЗ рд╕рдЯреАрдХ рд╕реВрдЪреА рджреЗрдиреЗ рдХреЗ рд▓рд┐рдП, рдХреГрдкрдпрд╛ рдореБрдЭреЗ рдмрддрд╛рдПрдВ рдХрд┐ рдЖрдк рдХрд┐рд╕ рд╢рд╣рд░ рдореЗрдВ рдЕрд╕реНрдкрддрд╛рд▓ рдЦреЛрдЬ рд░рд╣реЗ рд╣реИрдВред рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, рдЖрдк "<strong>рдиреЛрдПрдбрд╛ рдореЗрдВ рд╕рд░рдХрд╛рд░реА рдЕрд╕реНрдкрддрд╛рд▓</strong>" рдЯрд╛рдЗрдк рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред</p>
                    </div>`,
                    keywords: ['рд╕рд░рдХрд╛рд░реА рдЕрд╕реНрдкрддрд╛рд▓', 'рд╕рд░рдХрд╛рд░реА рдХреНрд▓рд┐рдирд┐рдХ', 'рд╕рд░рдХрд╛рд░реА рдбреЙрдХреНрдЯрд░', 'рд╕рд░рдХрд╛рд░реА рдХреНрд▓рд┐рдирд┐рдХ']
                },
                od: {
                    response: `ЁЯПе <strong>рмнрм╛рм░рмдрм░рнЗ рм╕рм░рмХрм╛рм░рнА рмбрм╛рмХрнНрмдрм░рмЦрм╛рмирм╛:</strong><br><br>
                    <div class="bg-cyan-100 text-cyan-800 p-4 rounded-lg my-2">
                        <p>рм╕рм░рмХрм╛рм░рнА рмбрм╛рмХрнНрмдрм░рмЦрм╛рмирм╛ рмЦрнЛрмЬрм┐рммрм╛ рм╣рнЗрмЙрмЫрм┐ рмХрморнН рмЦрм░рнНрмЪрнНрмЪрм░рнЗ рм╕рнНрн▒рм╛рм╕рнНрмернНрнЯ рм╕рнЗрммрм╛ рмкрм╛рмЗрммрм╛ рмкрм╛рмЗрмБ рмПрмХ рмЙрмдрнНрмХрнГрм╖рнНрмЯ рмЙрмкрм╛рнЯред рмЪрм┐рмирнНрмдрм╛ рмХрм░рмирнНрмдрнБ рмирм╛рм╣рм┐рмБ, рмЖрморнЗ рмПрмерм┐рм░рнЗ рмЖрмкрмгрмЩрнНрмХрнБ рм╕рм╛рм╣рм╛рмпрнНрнЯ рмХрм░рм┐рмкрм╛рм░рм┐рммрнБ! ЁЯШК</p>
                        <br>
                        <p>рм╕рммрнБрмарм╛рм░рнБ рмирм┐рмХрмЯрмдрмо рм╕рм░рмХрм╛рм░рнА рмбрм╛рмХрнНрмдрм░рмЦрм╛рмирм╛ рмЦрнЛрмЬрм┐рммрм╛ рмкрм╛рмЗрмБ, рмЖрмкрмг рмХрнЗрмЙрмБ рм╕рм╣рм░рм░рнЗ рмЕрмЫрмирнНрмдрм┐ рмдрм╛рм╣рм╛ рмХрнБрм╣рмирнНрмдрнБред рмЙрмжрм╛рм╣рм░рмг рм╕рнНрн▒рм░рнВрмк, рмЖрмкрмг "<strong>рмирнЛрмЗрмбрм╛рм░рнЗ рм╕рм░рмХрм╛рм░рнА рмбрм╛рмХрнНрмдрм░рмЦрм╛рмирм╛</strong>" рмЯрм╛рмЗрмкрнН рмХрм░рм┐рмкрм╛рм░рм┐рммрнЗред</p>
                    </div>`,
                    keywords: ['рм╕рм░рмХрм╛рм░рнА рмбрм╛рмХрнНрмдрм░рмЦрм╛рмирм╛', 'рм╕рм░рмХрм╛рм░рнА рмХрнНрм▓рм┐рмирм┐рмХрнН', 'рмбрм╛рмХрнНрмдрм░рмЦрм╛рмирм╛', 'рмХрнНрм▓рм┐рмирм┐рмХрнН']
                }
            },
            importantCityHospitals: {
                 noida: {
                    en: `Don't worry, here is a list of some government hospitals in <strong>Noida</strong>: ЁЯШК
                    <ul>
                        <li><strong>District Government Hospital, Sector 30</strong><br>Address: Sector 30, Noida, Uttar Pradesh 201301</li>
                        <li><strong>Government Institute of Medical Sciences (GIMS)</strong><br>Address: Greater Noida, Uttar Pradesh 201310</li>
                        <li><strong>ESIC Model Hospital</strong><br>Address: Sector 24, Noida, Uttar Pradesh 201301</li>
                    </ul>`,
                    hi: `рдЪрд┐рдВрддрд╛ рди рдХрд░реЗрдВ, <strong>рдиреЛрдПрдбрд╛</strong> рдореЗрдВ рдХреБрдЫ рд╕рд░рдХрд╛рд░реА рдЕрд╕реНрдкрддрд╛рд▓реЛрдВ рдХреА рд╕реВрдЪреА рдпрд╣рд╛рдБ рджреА рдЧрдИ рд╣реИ: ЁЯШК
                    <ul>
                        <li><strong>рдЬрд┐рд▓рд╛ рд╕рд░рдХрд╛рд░реА рдЕрд╕реНрдкрддрд╛рд▓, рд╕реЗрдХреНрдЯрд░ 30</strong><br>рдкрддрд╛: рд╕реЗрдХреНрдЯрд░ 30, рдиреЛрдПрдбрд╛, рдЙрддреНрддрд░ рдкреНрд░рджреЗрд╢ 201301</li>
                        <li><strong>рд╢рд╛рд╕рдХреАрдп рдЖрдпреБрд░реНрд╡рд┐рдЬреНрдЮрд╛рди рд╕рдВрд╕реНрдерд╛рди (GIMS)</strong><br>рдкрддрд╛: рдЧреНрд░реЗрдЯрд░ рдиреЛрдПрдбрд╛, рдЙрддреНрддрд░ рдкреНрд░рджреЗрд╢ 201310</li>
                        <li><strong>рдИрдПрд╕рдЖрдИрд╕реА рдореЙрдбрд▓ рдЕрд╕реНрдкрддрд╛рд▓</strong><br>рдкрддрд╛: рд╕реЗрдХреНрдЯрд░ 24, рдиреЛрдПрдбрд╛, рдЙрддреНрддрд░ рдкреНрд░рджреЗрд╢ 201301</li>
                    </ul>`,
                    od: `рмЪрм┐рмирнНрмдрм╛ рмХрм░рмирнНрмдрнБ рмирм╛рм╣рм┐рмБ, <strong>рмирнЛрмЗрмбрм╛</strong>рм░рнЗ рмХрм┐рмЫрм┐ рм╕рм░рмХрм╛рм░рнА рмбрм╛рмХрнНрмдрм░рмЦрм╛рмирм╛рм░ рмдрм╛рм▓рм┐рмХрм╛ рмПрмарм╛рм░рнЗ рмжрм┐рмЖрмпрм╛рмЗрмЫрм┐: ЁЯШК
                    <ul>
                        <li><strong>рмЬрм┐рм▓рнНрм▓рм╛ рм╕рм░рмХрм╛рм░рнА рмбрм╛рмХрнНрмдрм░рмЦрм╛рмирм╛, рм╕рнЗрмХрнНрмЯрм░ 30</strong><br>рмарм┐рмХрмгрм╛: рм╕рнЗрмХрнНрмЯрм░ 30, рмирнЛрмЗрмбрм╛, рмЙрмдрнНрмдрм░ рмкрнНрм░рмжрнЗрм╢ 201301</li>
                        <li><strong>рм╕рм░рмХрм╛рм░рнА рмЖрнЯрнБрм░рнНрммрм┐рмЬрнНрмЮрм╛рми рм╕рмВрм╕рнНрмерм╛рми (GIMS)</strong><br>рмарм┐рмХрмгрм╛: рмЧрнНрм░рнЗрмЯрм░ рмирнЛрмЗрмбрм╛, рмЙрмдрнНрмдрм░ рмкрнНрм░рмжрнЗрм╢ 201310</li>
                        <li><strong>ESIC рмормбрнЗрм▓рнН рм╣рм╕рнНрмкрм┐рмЯрм╛рм▓рнН</strong><br>рмарм┐рмХрмгрм╛: рм╕рнЗрмХрнНрмЯрм░ 24, рмирнЛрмЗрмбрм╛, рмЙрмдрнНрмдрм░ рмкрнНрм░рмжрнЗрм╢ 201301</li>
                    </ul>`
                }
            }
        };

        const criticalResponses = {
            en: `ЁЯЪи <strong>Urgent Medical Alert!</strong><br><br>
            <div class="bg-red-100 text-red-800 p-4 rounded-lg my-2">
                <p><strong>Please seek immediate medical attention.</strong></p>
                <p>Call the National Emergency Number <strong>112</strong> or an ambulance at <strong>108</strong>.</p>
                <p class="mt-2">For accurate medical advice, please consult a professional immediately.</p>
            </div>`,
            hi: `ЁЯЪи <strong>рдЖрдкрд╛рддрдХрд╛рд▓реАрди рдЪрд┐рдХрд┐рддреНрд╕рд╛ рдЪреЗрддрд╛рд╡рдиреА!</strong><br><br>
            <div class="bg-red-100 text-red-800 p-4 rounded-lg my-2">
                <p><strong>рдХреГрдкрдпрд╛ рддреБрд░рдВрдд рдЪрд┐рдХрд┐рддреНрд╕рд╛ рд╕рд╣рд╛рдпрддрд╛ рд▓реЗрдВред</strong></p>
                <p>рд░рд╛рд╖реНрдЯреНрд░реАрдп рдЖрдкрд╛рддрдХрд╛рд▓реАрди рдирдВрдмрд░ <strong>112</strong> рдпрд╛ рдПрдореНрдмреБрд▓реЗрдВрд╕ рдХреЛ <strong>108</strong> рдкрд░ рдХреЙрд▓ рдХрд░реЗрдВред</p>
                <p class="mt-2">рд╕рдЯреАрдХ рдЪрд┐рдХрд┐рддреНрд╕рд╛ рд╕рд▓рд╛рд╣ рдХреЗ рд▓рд┐рдП, рдХреГрдкрдпрд╛ рддреБрд░рдВрдд рдХрд┐рд╕реА рдкреЗрд╢реЗрд╡рд░ рд╕реЗ рдкрд░рд╛рдорд░реНрд╢ рдХрд░реЗрдВред</p>
            </div>`,
            od: `ЁЯЪи <strong>рмЬрм░рнБрм░рнАрмХрм╛рм│рнАрми рмбрм╛рмХрнНрмдрм░рнА рм╕рмдрм░рнНрмХрмдрм╛!</strong><br><br>
            <div class="bg-red-100 text-red-800 p-4 rounded-lg my-2">
                <p><strong>рмжрнЯрм╛рмХрм░рм┐ рмдрнБрм░рмирнНрмд рмбрм╛рмХрнНрмдрм░рнА рм╕рм╣рм╛рнЯрмдрм╛ рм▓рнЛрмбрм╝рмирнНрмдрнБред</strong></p>
                <p>рмЬрм╛рмдрнАрнЯ рмЬрм░рнБрм░рнАрмХрм╛рм│рнАрми рмирморнНрммрм░ <strong>112</strong> рмХрнБ рмХрм▓рнН рмХрм░рмирнНрмдрнБ рмХрм┐рморнНрммрм╛ рмЖрморнНрммрнБрм▓рм╛рмирнНрм╕ рмкрм╛рмЗрмБ <strong>108</strong> рмХрнБ рмХрм▓рнН рмХрм░рмирнНрмдрнБред</p>
                <p class="mt-2">рм╕рмарм┐рмХрнН рмбрм╛рмХрнНрмдрм░рнА рмкрм░рм╛рморм░рнНрм╢ рмкрм╛рмЗрмБ, рмжрнЯрм╛рмХрм░рм┐ рмдрнБрм░рмирнНрмд рмЬрмгрнЗ рмкрнНрм░рмлрнЗрм╕рмирм╛рм▓рмЩрнНрмХ рм╕рм╣рм┐рмд рмкрм░рм╛рморм░рнНрм╢ рмХрм░рмирнНрмдрнБред</p>
            </div>`
        };

        // Event listeners
        window.addEventListener('load', () => {
            updateUIText(currentLanguage);
            highlightVoiceFeature();
        });
        sendBtn.addEventListener('click', processMessage);
        messageInput.addEventListener('keypress', handleKeyPress);
        document.querySelectorAll('.quick-btn').forEach(button => {
            button.addEventListener('click', () => {
                const query = button.getAttribute('data-query');
                messageInput.value = query;
                processMessage();
            });
        });
        voiceBtn.addEventListener('click', toggleVoiceInput);
        keyboardBtn.addEventListener('click', toggleKeyboard);
        closeTooltipBtn.addEventListener('click', hideVoiceTooltip);

        
        // Function to update all UI text based on the selected language
        function updateUIText(lang) {
            const langTranslations = translations[lang] || translations.en;
            initialMessageContainer.innerHTML = langTranslations.initialMessage;
            messageInput.placeholder = langTranslations.placeholder;
            searchingMessage.textContent = langTranslations.searching;
            tooltipText.textContent = langTranslations.voiceTooltip; // Update tooltip text
        }

        // Function to set the conversation language
        function setLanguage(lang) {
            currentLanguage = lang;
            document.querySelectorAll('.lang-btn').forEach(btn => btn.classList.remove('active'));
            document.getElementById(`lang-${lang}`).classList.add('active');
            
            // Clear chat and update UI to new language
            chatArea.innerHTML = '';
            const typingIndicator = `<div id="typingIndicator" class="typing-indicator flex items-center space-x-1 p-3 bg-white rounded-xl shadow-sm w-fit">
                <div class="w-2 h-2 bg-gray-400 rounded-full animate-pulse-delay-0"></div>
                <div class="w-2 h-2 bg-gray-400 rounded-full animate-pulse-delay-1"></div>
                <div class="w-2 h-2 bg-gray-400 rounded-full animate-pulse-delay-2"></div>
            </div>`;
            chatArea.innerHTML = `<div id="initialMessageContainer"></div>${typingIndicator}`;
            updateUIText(lang);

            addMessage(translations[lang].languageChanged, false);

            if (!virtualKeyboard.classList.contains('hidden')) {
                renderKeyboard();
            }
        }

        function addMessage(message, isUser = false) {
            const messageDiv = document.createElement('div');
            messageDiv.className = `message message-enter-active p-3 rounded-xl shadow-sm max-w-xs sm:max-w-md ${isUser ? 'user-message text-white ml-auto' : 'bot-message text-gray-800'}`;
            messageDiv.innerHTML = message;
            
            const typingIndicator = document.getElementById('typingIndicator');
            chatArea.insertBefore(messageDiv, typingIndicator);
            
            chatArea.scrollTop = chatArea.scrollHeight;
        }

        function handleKeyPress(event) {
            if (event.key === 'Enter') {
                processMessage();
            }
        }
        
        function showSearchingOverlay() {
            searchingMessage.textContent = translations[currentLanguage].searching;
            searchingOverlay.classList.remove('hidden');
        }

        function hideSearchingOverlay() {
            searchingOverlay.classList.add('hidden');
        }

        function isCritical(query) {
            const criticalKeywords = ['chest pain', 'severe pain', 'severe bleeding', 'breathing difficulty', 'difficulty breathing', 'unconscious', 'fainting', 'heart attack', 'stroke', 'рдЫрд╛рддреА рдореЗрдВ рджрд░реНрдж', 'рдЧрдВрднреАрд░ рджрд░реНрдж', 'рд╕рд╛рдВрд╕ рд▓реЗрдиреЗ рдореЗрдВ рджрд┐рдХреНрдХрдд', 'рддреЗрдЬ рджрд░реНрдж', 'рд░рдХреНрддрд╕реНрд░рд╛рд╡', 'рдЕрдЪреЗрдд', 'рд╣реГрджрдп рдШрд╛рдд', 'рдЫрд╛рддреА', 'рм╣рнГрмжрмШрм╛рмд', 'рм╕рм╛рмВрмШрм╛рмдрм┐рмХ рмпрмирнНрмдрнНрм░рмгрм╛', 'рм░рмХрнНрмдрм╕рнНрм░рм╛рмм', 'рмЕрмЬрнНрмЮрм╛рми', 'рмЫрм╛рмдрм┐ рмпрмирнНрмдрнНрм░рмгрм╛', 'рмирм┐рм╢рнНрн▒рм╛рм╕ рмирнЗрммрм╛рм░рнЗ рмЕрм╕рнБрммрм┐рмзрм╛'];
            const lowerCaseQuery = query.toLowerCase();
            return criticalKeywords.some(keyword => lowerCaseQuery.includes(keyword));
        }

        async function processMessage() {
            const userMessage = messageInput.value.trim();
            if (userMessage === '') return;

            addMessage(userMessage, true);
            messageInput.value = '';
            virtualKeyboard.classList.add('hidden'); // Hide keyboard on send

            if (isCritical(userMessage)) {
                addMessage(criticalResponses[currentLanguage], false);
                return;
            }
            
            const lowerCaseUserMessage = userMessage.toLowerCase();
            
            if (knowledgeBase.womensHealth[currentLanguage]?.keywords.some(keyword => lowerCaseUserMessage.includes(keyword))) {
                 addMessage(knowledgeBase.womensHealth[currentLanguage].response, false);
                 return;
            }
            
            if (knowledgeBase.diseaseOutbreaks[currentLanguage]?.keywords.some(keyword => lowerCaseUserMessage.includes(keyword))) {
                await fetchGovtHealthAlerts();
                return;
            }

            const cityMatch = /(?:in|at|located in|located at)\s+([a-zA-Z\s]+)/i.exec(userMessage);
            const city = cityMatch ? cityMatch[1].trim().toLowerCase() : null;

            if (city && knowledgeBase.importantCityHospitals[city]) {
                addMessage(knowledgeBase.importantCityHospitals[city][currentLanguage] || knowledgeBase.importantCityHospitals[city].en, false);
                return;
            }
            
            if (knowledgeBase.govtHospitals[currentLanguage]?.keywords.some(keyword => lowerCaseUserMessage.includes(keyword))) {
                if (city) {
                    await handleHospitalSearch(city);
                } else {
                    addMessage(knowledgeBase.govtHospitals[currentLanguage].response, false);
                }
                return;
            }

            showSearchingOverlay();

            try {
                const payload = {
                    contents: [{ parts: [{ text: userMessage }] }],
                    tools: [{ "google_search": {} }],
                    systemInstruction: {
                        parts: [{
                            text: `You are Sushruta, a chill and reassuring AI Health Assistant. Your tone should be calm, relaxed, and not cause any panic. Reassure the user with phrases like "Don't worry," and focus on providing simple, actionable advice. Respond to user health queries in a point-based format. Your response must be grounded in real-time search results to ensure accuracy.
                            
                            When asked for a solution related to a health issue in India, search for official advisories and solutions from the Indian Ministry of Health and Family Welfare, National Health Mission, or other official Indian government health portals.

                            Please follow these formatting rules strictly:
                            1. Begin your response with a disclaimer that you are not a substitute for a professional medical doctor.
                            2. Provide a clear, easy-to-read list of symptoms.
                            3. Provide a clear, easy-to-read list of recommended precautions or solutions.
                            4. Use HTML strong tags (<strong></strong>) to bold and highlight important keywords.
                            5. Use HTML list tags (<ul><li>) for all lists.
                            6. Do not use asterisks or any other markdown for bullet points.
                            7. Do not over-concise the answer.
                            8. Respond in the language requested by the user. The user's preferred language is ${currentLanguage}.
                            9. Use relevant emojis where appropriate. ЁЯШК`
                        }]
                    },
                };
                
                const response = await fetch(API_URL, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(payload)
                });
                
                if (response.status === 401) {
                    console.error("API Error: 401 Unauthorized. Please ensure your API key is valid.");
                    addMessage("I'm sorry, I'm unable to connect. Please check the API key and try again.", false);
                    return;
                }

                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }

                const result = await response.json();
                const candidate = result?.candidates?.[0];

                if (candidate && candidate.content?.parts?.[0]?.text) {
                    const botResponseText = candidate.content.parts[0].text;
                    addMessage(botResponseText, false);

                } else {
                    addMessage("Sorry, I could not generate a response. Please try again.", false);
                }

            } catch (error) {
                console.error("General Error:", error);
                addMessage("I'm sorry, an unexpected error occurred. Please try again later.", false);
            } finally {
                hideSearchingOverlay();
            }
        }
        
        async function fetchGovtHealthAlerts() {
            showSearchingOverlay();
            await new Promise(resolve => setTimeout(resolve, 1500)); // Simulate API call
            const mockGovtData = {
                en: `ЁЯУД <strong>Health Advisory (as of Sep 10, 2025)</strong><br>
                Latest alerts from the Ministry of Health: ЁЯШК
                <ul>
                    <li><strong>Dengue & Chikungunya:</strong> Cases are rising. Protect yourself from mosquito bites.</li>
                    <li><strong>Viral Fever Watch (UP):</strong> Seasonal increase noted in Noida. Maintain hygiene.</li>
                    <li><strong>Seasonal Flu:</strong> Vaccination recommended for high-risk groups.</li>
                </ul>`,
                hi: `ЁЯУД <strong>рд╕реНрд╡рд╛рд╕реНрдереНрдп рд╕рд▓рд╛рд╣ (10 рд╕рд┐рддрдВрдмрд░, 2025)</strong><br>
                рд╕реНрд╡рд╛рд╕реНрдереНрдп рдордВрддреНрд░рд╛рд▓рдп рд╕реЗ рдирд╡реАрдирддрдо рдЕрд▓рд░реНрдЯ: ЁЯШК
                <ul>
                    <li><strong>рдбреЗрдВрдЧреВ рдФрд░ рдЪрд┐рдХрдирдЧреБрдирд┐рдпрд╛:</strong> рдорд╛рдорд▓реЗ рдмрдврд╝ рд░рд╣реЗ рд╣реИрдВред рдордЪреНрдЫрд░реЛрдВ рдХреЗ рдХрд╛рдЯрдиреЗ рд╕реЗ рдЦреБрдж рдХреЛ рдмрдЪрд╛рдПрдВред</li>
                    <li><strong>рд╡рд╛рдпрд░рд▓ рдлреАрд╡рд░ рд╡реЙрдЪ (рдпреВрдкреА):</strong> рдиреЛрдПрдбрд╛ рдореЗрдВ рдореМрд╕рдореА рд╡реГрджреНрдзрд┐ред рд╕реНрд╡рдЪреНрдЫрддрд╛ рдмрдирд╛рдП рд░рдЦреЗрдВред</li>
                    <li><strong>рдореМрд╕рдореА рдлреНрд▓реВ:</strong> рдЙрдЪреНрдЪ рдЬреЛрдЦрд┐рдо рд╡рд╛рд▓реЗ рд╕рдореВрд╣реЛрдВ рдХреЗ рд▓рд┐рдП рдЯреАрдХрд╛рдХрд░рдг рдХреА рд╕рд┐рдлрд╛рд░рд┐рд╢ рдХреА рдЬрд╛рддреА рд╣реИред</li>
                </ul>`,
                od: `ЁЯУД <strong>рм╕рнНрн▒рм╛рм╕рнНрмернНрнЯ рмкрм░рм╛рморм░рнНрм╢ (рм╕рнЗрмкрнНрмЯрнЗрморнНрммрм░ 10, 2025)</strong><br>
                рм╕рнНрн▒рм╛рм╕рнНрмернНрнЯ рмормирнНрмдрнНрм░рмгрм╛рм│рнЯрм░рнБ рм╕рм░рнНрммрм╢рнЗрм╖ рм╕рмдрм░рнНрмХрмдрм╛: ЁЯШК
                <ul>
                    <li><strong>рмбрнЗрмЩрнНрмЧрнБ рмПрммрмВ рмЪрм┐рмХрмирмЧрнБрмирм┐рмЖ:</strong> рморм╛рморм▓рм╛ рммрмврнБрмЫрм┐ред рмирм┐рмЬрмХрнБ рморм╢рм╛ рмХрм╛рморнБрмбрм╝рм╛рм░рнБ рм░рмХрнНрм╖рм╛ рмХрм░рмирнНрмдрнБред</li>
                    <li><strong>рмнрм╛рмЗрм░рм╛рм▓рнН рмЬрнНрн▒рм░ (UP):</strong> рмирнЛрмПрмбрм╛рм░рнЗ рморнМрм╕рнБрморнА рммрнГрмжрнНрмзрм┐ред рм╕рнНрн▒рмЪрнНрмЫрмдрм╛ рммрмЬрм╛рнЯ рм░рмЦрмирнНрмдрнБред</li>
                    <li><strong>рморнМрм╕рнБрморнА рмлрнНрм▓рнБ:</strong> рмЙрмЪрнНрмЪ-рммрм┐рмкрмж рмерм┐рммрм╛ рмЧрнЛрм╖рнНрмарнАрмЩрнНрмХ рмкрм╛рмЗрмБ рмЯрнАрмХрм╛рмХрм░рмг рм╕рнБрмкрм╛рм░рм┐рм╢ рмХрм░рм╛рмпрм╛рмПред</li>
                </ul>`
            };
            addMessage(mockGovtData[currentLanguage] || mockGovtData.en, false);
            hideSearchingOverlay();
        }

        async function handleHospitalSearch(city) {
            showSearchingOverlay();
             await new Promise(resolve => setTimeout(resolve, 1000)); // Simulate API call
             const cityData = knowledgeBase.importantCityHospitals[city.toLowerCase()];
             if(cityData){
                 addMessage(cityData[currentLanguage] || cityData.en, false);
             } else {
                 addMessage(`I'm sorry, I couldn't find a list of government hospitals in ${city}. Please try searching with a different city name.`, false);
             }
            hideSearchingOverlay();
        }

        const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;
        let recognition;
        let isListening = false;

        if (SpeechRecognition) {
            recognition = new SpeechRecognition();
            recognition.continuous = false;
            recognition.interimResults = false;
            recognition.lang = getVoiceLanguage(currentLanguage);

            recognition.onstart = () => { isListening = true; micIcon.classList.add('voice-icon', 'listening'); };
            recognition.onend = () => { isListening = false; micIcon.classList.remove('voice-icon', 'listening'); };
            recognition.onresult = (event) => { messageInput.value = event.results[0][0].transcript; sendBtn.click(); };
            recognition.onerror = (event) => { console.error("Speech Recognition Error:", event.error); isListening = false; micIcon.classList.remove('voice-icon', 'listening'); };
        } else {
            voiceBtn.style.display = 'none';
        }

        function toggleVoiceInput() {
            if(!recognition) return;
            if (isListening) {
                recognition.stop();
            } else {
                recognition.lang = getVoiceLanguage(currentLanguage);
                recognition.start();
            }
        }
        
        function getVoiceLanguage(lang) {
            const voiceMap = { 'en': 'en-IN', 'hi': 'hi-IN', 'bn': 'bn-IN', 'ta': 'ta-IN', 'od': 'or-IN' };
            return voiceMap[lang] || 'en-IN';
        }

        const keyboardLayouts = {
            en: ["q", "w", "e", "r", "t", "y", "u", "i", "o", "p", "a", "s", "d", "f", "g", "h", "j", "k", "l", "z", "x", "c", "v", "b", "n", "m", " ", "тЖР"],
            hi: ["рдХ", "рдЦ", "рдЧ", "рдШ", "рдЩ", "рдЪ", "рдЫ", "рдЬ", "рдЭ", "рдЮ", "рдЯ", "рда", "рдб", "рдв", "рдг", "рдд", "рде", "рдж", "рдз", "рди", "рдк", "рдл", "рдм", "рдн", "рдо", "рдп", "рд░", "рд▓", "рд╡", "рд╢", "рд╖", "рд╕", "рд╣", " ", "тЖР"],
            bn: ["ржХ", "ржЦ", "ржЧ", "ржШ", "ржЩ", "ржЪ", "ржЫ", "ржЬ", "ржЭ", "ржЮ", "ржЯ", "ржа", "ржб", "ржв", "ржг", "ржд", "рже", "ржж", "ржз", "ржи", "ржк", "ржл", "ржм", "ржн", "ржо", "ржп", "рж░", "рж▓", "ржм", "рж╢", "рж╖", "рж╕", "рж╣", " ", "тЖР"],
            ta: ["роХ", "роЩ", "роЪ", "роЮ", "роЯ", "рог", "род", "рои", "рок", "роо", "роп", "ро░", "ро▓", "ро╡", "ро┤", "ро│", "ро▒", "рой", "роЬ", "ро╖", "ро╕", "ро╣", "роХрпНро╖", "ро╕рпНро░рпА", " ", "тЖР"],
            od: ["рмХ", "рмЦ", "рмЧ", "рмШ", "рмЩ", "рмЪ", "рмЫ", "рмЬ", "рмЭ", "рмЮ", "рмЯ", "рма", "рмб", "рмв", "рмг", "рмд", "рме", "рмж", "рмз", "рми", "рмк", "рмл", "рмм", "рмн", "рмо", "рмп", "рм░", "рм▓", "рм╡", "рм╢", "рм╖", "рм╕", "рм╣", " ", "тЖР"]
        };
        
        function renderKeyboard() {
            keyboardLayout.innerHTML = '';
            const layout = keyboardLayouts[currentLanguage] || keyboardLayouts.en;
            const keysPerRow = 10;
            keyboardLayout.style.gridTemplateColumns = `repeat(${keysPerRow}, 1fr)`;
            
            layout.forEach(key => {
                const button = document.createElement('button');
                button.textContent = key;
                button.className = 'bg-white hover:bg-gray-100 text-gray-800 p-2 rounded-md text-base font-semibold transition';
                if (key === 'тЖР') {
                    button.onclick = () => messageInput.value = messageInput.value.slice(0, -1);
                } else if (key === ' ') {
                    button.onclick = () => messageInput.value += ' ';
                    button.classList.add('col-span-4'); // Make space bar wider
                } else {
                    button.onclick = () => messageInput.value += key;
                }
                keyboardLayout.appendChild(button);
            });
        }
        
        function toggleKeyboard() {
            virtualKeyboard.classList.toggle('hidden');
            if (!virtualKeyboard.classList.contains('hidden')) {
                renderKeyboard();
            }
        }

        function highlightVoiceFeature() {
            if(window.innerWidth > 640) { // Only show on desktop
                voiceTooltip.classList.remove('hidden');
                setTimeout(() => { 
                     voiceTooltip.classList.remove('opacity-0');
                     voiceTooltip.classList.add('opacity-100');
                }, 10);
                voiceBtn.classList.add('voice-btn-highlight');
                setTimeout(hideVoiceTooltip, 10000);
            }
        }

        function hideVoiceTooltip() {
            voiceTooltip.classList.remove('opacity-100');
            voiceTooltip.classList.add('opacity-0');
            voiceBtn.classList.remove('voice-btn-highlight');
            setTimeout(() => {
                voiceTooltip.classList.add('hidden');
            }, 300);
        }
    </script>
</body>
</html>

