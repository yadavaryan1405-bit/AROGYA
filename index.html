<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sushruta - AI Health Assistant</title>
    <!-- Tailwind CSS and Inter font -->
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        html, body {
            height: 100%;
            overflow: hidden; /* Prevent scrolling on the body */
        }
        body {
            font-family: 'Inter', sans-serif;
            background-color: #FAF8F7; /* Warmer off-white */
            display: flex;
            align-items: center;
            justify-content: center;
        }
        /* Main container with refined shadow */
        .chat-container {
            position: relative;
            width: 100%;
            height: 100%;
            background-color: #ffffff;
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }

        /* Apply responsive styles for larger screens */
        @media (min-width: 640px) {
            .chat-container {
                max-width: 36rem; /* Wider for tablets */
                height: 90vh;
                max-height: 800px;
                border-radius: 1.5rem;
                box-shadow: 0 20px 40px rgba(0, 0, 0, 0.08);
            }
             body {
                padding: 1rem;
            }
        }

        @media (min-width: 1024px) {
            .chat-container {
                max-width: 48rem; /* Even wider for desktops */
            }
        }
        
        /* NEW: Header with a soothing gradient */
        .header {
            background: linear-gradient(135deg, #F9A826, #E67E22); /* Saffron to Carrot gradient */
            color: white;
            padding: 1rem 1.5rem;
            display: flex;
            flex-direction: column;
            align-items: center;
            text-align: center;
            position: relative;
            z-index: 10;
        }
        /* Custom scrollbar for the chat area */
        .chat-area::-webkit-scrollbar {
            width: 8px;
        }
        .chat-area::-webkit-scrollbar-thumb {
            background-color: #9ca3af;
            border-radius: 4px;
        }
        /* Language button active state */
        .lang-btn.active {
            background-color: rgba(255, 255, 255, 0.2);
            font-weight: 600;
        }
        .lang-btn {
             transition: background-color 0.2s ease-in-out;
        }
        /* Animation for messages appearing */
        .message-enter-active { animation: fadeIn 0.5s ease-out; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
        
        /* Custom typing indicator animation */
        @keyframes pulse-delay-0 { 0%, 80%, 100% { opacity: 0.2; } 40% { opacity: 1; } }
        @keyframes pulse-delay-1 { 0%, 80%, 100% { opacity: 0.2; } 40% { opacity: 1; } }
        @keyframes pulse-delay-2 { 0%, 80%, 100% { opacity: 0.2; } 40% { opacity: 1; } }
        .animate-pulse-delay-0 { animation: pulse-delay-0 1.5s infinite; }
        .animate-pulse-delay-1 { animation: pulse-delay-1 1.5s infinite 0.2s; }
        .animate-pulse-delay-2 { animation: pulse-delay-2 1.5s infinite 0.4s; }
        .typing-indicator { display: none; }
        .quick-btn {
            transition: all 0.2s ease-in-out;
            transform: translateY(0);
            border: 1px solid #d1d5db;
        }
        .quick-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 10px rgba(0,0,0,0.05);
            border-color: #F9A826; /* Saffron border on hover */
            color: #F9A826;
        }
        .voice-icon.listening {
            animation: pulse-red 1.5s infinite;
        }
        @keyframes pulse-red {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.2); }
        }
        /* Animation to highlight the voice button */
        @keyframes pulse-blue {
            0% { box-shadow: 0 0 0 0 rgba(249, 168, 38, 0.7); } /* Saffron glow */
            70% { box-shadow: 0 0 0 10px rgba(249, 168, 38, 0); }
            100% { box-shadow: 0 0 0 0 rgba(249, 168, 38, 0); }
        }
        .voice-btn-highlight {
            animation: pulse-blue 2s infinite;
        }

        /* Improved chat bubble styles */
        .user-message {
            background: linear-gradient(135deg, #F9A826, #E67E22); /* Saffron to Carrot gradient for user */
        }
        .bot-message {
            background-color: #FDFBF8; /* Creamy off-white for bot */
            border: 1px solid #F0EBE3;
        }
    </style>
</head>
<body class="bg-gray-100">

    <div class="chat-container">
        
        <!-- Medical Disclaimer Banner -->
        <div class="bg-red-600 text-white text-center text-xs py-1 px-4 font-medium flex-shrink-0">
            ‚ö†Ô∏è Disclaimer: This is an AI tool and not a substitute for professional medical advice.
        </div>

        <!-- Header -->
        <header class="header flex-shrink-0">
            <h1 class="text-2xl sm:text-3xl font-bold tracking-tight mb-1">Sushruta</h1>
            <p class="text-xs sm:text-sm text-orange-100">Your AI Health Assistant</p>
            <div class="flex flex-col sm:flex-row justify-between items-center w-full mt-3 space-y-3 sm:space-y-0">
                <div class="flex space-x-4 text-xs">
                    <div class="flex flex-col items-center">
                        <span class="font-semibold text-white">92%</span>
                        <span class="text-orange-100 text-xxs">Accuracy</span>
                    </div>
                    <div class="flex flex-col items-center">
                        <span class="font-semibold text-white">8</span>
                        <span class="text-orange-100 text-xxs">Languages</span>
                    </div>
                    <div class="flex flex-col items-center">
                        <span class="font-semibold text-white">100K+</span>
                        <span class="text-orange-100 text-xxs">Users Helped</span>
                    </div>
                </div>
                <div class="flex flex-wrap justify-center gap-1">
                    <button class="lang-btn text-white px-2 py-1 text-xs rounded-full active" onclick="setLanguage('en')" id="lang-en">English</button>
                    <button class="lang-btn text-white px-2 py-1 text-xs rounded-full" onclick="setLanguage('hi')" id="lang-hi">‡§π‡§ø‡§Ç‡§¶‡•Ä</button>
                    <button class="lang-btn text-white px-2 py-1 text-xs rounded-full" onclick="setLanguage('bn')" id="lang-bn">‡¶¨‡¶æ‡¶Ç‡¶≤‡¶æ</button>
                    <button class="lang-btn text-white px-2 py-1 text-xs rounded-full" onclick="setLanguage('ta')" id="lang-ta">‡Æ§‡ÆÆ‡Æø‡Æ¥‡Øç</button>
                    <button class="lang-btn text-white px-2 py-1 text-xs rounded-full" onclick="setLanguage('od')" id="lang-od">‡¨ì‡¨°‡¨º‡¨ø‡¨Ü</button>
                </div>
            </div>
        </header>

        <!-- Quick Actions -->
        <div class="p-2 bg-white flex flex-wrap gap-2 justify-center border-b border-gray-200 sticky top-0 z-10 flex-shrink-0">
            <button class="quick-btn bg-white text-gray-600 text-xs font-semibold px-3 py-1.5 rounded-full" data-query="Symptoms of Fever">üå°Ô∏è Fever</button>
            <button class="quick-btn bg-white text-gray-600 text-xs font-semibold px-3 py-1.5 rounded-full" data-query="What is COVID-19?">üò∑ COVID-19</button>
            <button class="quick-btn bg-white text-gray-600 text-xs font-semibold px-3 py-1.5 rounded-full" data-query="Child Vaccination Schedule">üíâ Vaccination</button>
            <button class="quick-btn bg-white text-gray-600 text-xs font-semibold px-3 py-1.5 rounded-full" data-query="Remedies for Cough">üò§ Cough</button>
            <button class="quick-btn bg-red-500 hover:bg-red-600 text-white text-xs font-semibold px-3 py-1.5 rounded-full border-red-500" data-query="Emergency medical help">üö® Emergency</button>
            <button class="quick-btn bg-rose-500 hover:bg-rose-600 text-white text-xs font-semibold px-3 py-1.5 rounded-full border-rose-500" data-query="Women's Health">‚ôÄÔ∏è Women's Health</button>
        </div>

        <!-- Chat Area -->
        <main id="chatArea" class="chat-area flex-1 p-4 overflow-y-auto bg-white space-y-4">
            <!-- Initial Bot Message will be dynamically inserted here -->
            <div id="initialMessageContainer"></div>
            <!-- Typing Indicator with better animation -->
            <div id="typingIndicator" class="typing-indicator flex items-center space-x-1 p-3 bg-gray-100 rounded-xl shadow-sm w-fit">
                <div class="w-2 h-2 bg-gray-400 rounded-full animate-pulse-delay-0"></div>
                <div class="w-2 h-2 bg-gray-400 rounded-full animate-pulse-delay-1"></div>
                <div class="w-2 h-2 bg-gray-400 rounded-full animate-pulse-delay-2"></div>
            </div>
        </main>
        
        <!-- Input Area -->
        <footer class="bg-white p-2 border-t border-gray-200 flex items-center space-x-2 relative flex-shrink-0">
            <!-- NEW: Tooltip for Voice Feature -->
            <div id="voice-tooltip" class="hidden absolute -top-12 left-2 bg-gray-800 text-white text-xs rounded-md px-3 py-2 shadow-lg z-20 transition-opacity duration-300 opacity-0">
                <span id="tooltip-text"></span>
                <button id="close-tooltip" class="ml-2 font-bold text-lg leading-none">&times;</button>
            </div>
            <!-- Voice Input Button -->
            <button id="voiceBtn" class="bg-green-800 hover:bg-green-900 text-white p-2 rounded-full shadow-lg transition-all transform hover:scale-105 flex-shrink-0">
                <svg id="mic-icon" xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                    <path stroke-linecap="round" stroke-linejoin="round" d="M19 11a7 7 0 01-7 7v0a7 7 0 01-7-7v0a7 7 0 017-7v0a7 7 0 017 7z" />
                    <path stroke-linecap="round" stroke-linejoin="round" d="M12 21v-4m-4 4h8" />
                </svg>
            </button>
            <input type="text" id="messageInput" placeholder="Ask a health question..." class="flex-1 px-4 py-2 bg-gray-100 rounded-full text-sm border-2 border-transparent focus:outline-none focus:border-orange-500 transition-all" onkeypress="handleKeyPress(event)">
            <button id="sendBtn" class="bg-green-800 hover:bg-green-900 text-white font-semibold px-4 py-2 rounded-full shadow-lg transition-all transform hover:scale-105 flex-shrink-0">Send</button>
        </footer>
        <!-- Virtual Keyboard Toggle for Mobile -->
        <button id="keyboardBtn" class="sm:hidden fixed bottom-16 right-4 bg-gray-200 hover:bg-gray-300 text-gray-800 p-3 rounded-full shadow-lg transition-all transform hover:scale-105 z-20">
            <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                <path stroke-linecap="round" stroke-linejoin="round" d="M9.75 17L9 20l-1 1h8l-1-1-.75-3M3 13h18M5 17h14a2 2 0 002-2V5a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z" />
            </svg>
        </button>
        <!-- Virtual Keyboard -->
        <div id="virtualKeyboard" class="bg-gray-200 p-2 border-t border-gray-200 hidden flex-shrink-0">
            <div id="keyboardLayout" class="grid gap-1"></div>
        </div>
    </div>
    
    <!-- New: Searching Overlay/Modal -->
    <div id="searchingOverlay" class="fixed inset-0 bg-gray-800 bg-opacity-70 flex items-center justify-center z-50 hidden">
        <div class="bg-white rounded-xl shadow-lg p-6 text-center max-w-sm w-full animate-pulse mx-4">
            <p class="text-lg font-semibold text-gray-800" id="searchingMessage"></p>
        </div>
    </div>

    <script>
        // This variable should be replaced with a valid API key for the generative features to work.
        // It's intentionally left blank here for security reasons.
        const apiKey = "AIzaSyDY4WUNKFyJmTDKZFCi0xZjLZvoMxsNTNo";
        const API_MODEL = "gemini-2.5-flash-preview-05-20";
        const API_URL = `https://generativelanguage.googleapis.com/v1beta/models/${API_MODEL}:generateContent?key=${apiKey}`;

        // Chat history and current language state
        let chatHistory = [{
            role: "user",
            parts: [{ text: "Start a health-related conversation with a person and respond in the user's preferred language." }],
        }];
        let currentLanguage = 'en';

        // Get DOM elements
        const chatArea = document.getElementById('chatArea');
        const messageInput = document.getElementById('messageInput');
        const sendBtn = document.getElementById('sendBtn');
        const searchingOverlay = document.getElementById('searchingOverlay');
        const searchingMessage = document.getElementById('searchingMessage');
        const voiceBtn = document.getElementById('voiceBtn');
        const keyboardBtn = document.getElementById('keyboardBtn');
        const virtualKeyboard = document.getElementById('virtualKeyboard');
        const keyboardLayout = document.getElementById('keyboardLayout');
        const micIcon = document.getElementById('mic-icon');
        const initialMessageContainer = document.getElementById('initialMessageContainer');
        // NEW: Tooltip elements
        const voiceTooltip = document.getElementById('voice-tooltip');
        const tooltipText = document.getElementById('tooltip-text');
        const closeTooltipBtn = document.getElementById('close-tooltip');


            // NEW: Centralized translations for UI text
        const translations = {
            en: {
                initialMessage: `<div class="message bot-message p-4 rounded-xl max-w-lg animate-slideIn">
                    <p class="font-bold text-gray-800">Hi, I'm Sushruta, your friendly AI Health Assistant! ü©∫</p>
                    <p class="text-sm text-gray-600 mt-1">I can help with disease symptoms, vaccination schedules, and more. üòä</p>
                    <p class="text-xs text-gray-400 mt-3 italic">Please ask your question or use the buttons above.</p>
                </div>`,
                placeholder: "Type your health question...",
                searching: "Searching for a solution... üîç",
                languageChanged: "‚úÖ Language changed to English.",
                voiceTooltip: "New! Tap the mic to ask with your voice."
            },
            hi: {
                initialMessage: `<div class="message bot-message p-4 rounded-xl max-w-lg animate-slideIn">
                    <p class="font-bold text-gray-800">‡§®‡§Æ‡§∏‡•ç‡§§‡•á, ‡§Æ‡•à‡§Ç ‡§∏‡•Å‡§∂‡•ç‡§∞‡•Å‡§§ ‡§π‡•Ç‡§Å, ‡§Ü‡§™‡§ï‡§æ ‡§è‡§Ü‡§à ‡§∏‡•ç‡§µ‡§æ‡§∏‡•ç‡§•‡•ç‡§Ø ‡§∏‡§π‡§æ‡§Ø‡§ï! ü©∫</p>
                    <p class="text-sm text-gray-600 mt-1">‡§Æ‡•à‡§Ç ‡§Ü‡§™‡§ï‡•Ä ‡§Æ‡§¶‡§¶ ‡§ï‡§∞‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è ‡§Ø‡§π‡§æ‡§Å ‡§π‡•Ç‡§Å! üòä</p>
                    <p class="text-xs text-gray-400 mt-3 italic">‡§ï‡•É‡§™‡§Ø‡§æ ‡§Ö‡§™‡§®‡§æ ‡§™‡•ç‡§∞‡§∂‡•ç‡§® ‡§™‡•Ç‡§õ‡•á‡§Ç ‡§Ø‡§æ ‡§ä‡§™‡§∞ ‡§¶‡§ø‡§è ‡§ó‡§è ‡§¨‡§ü‡§®‡•ã‡§Ç ‡§ï‡§æ ‡§â‡§™‡§Ø‡•ã‡§ó ‡§ï‡§∞‡•á‡§Ç‡•§</p>
                </div>`,
                placeholder: "‡§Ö‡§™‡§®‡§æ ‡§∏‡•ç‡§µ‡§æ‡§∏‡•ç‡§•‡•ç‡§Ø ‡§™‡•ç‡§∞‡§∂‡•ç‡§® ‡§Ø‡§π‡§æ‡§Å ‡§≤‡§ø‡§ñ‡•á‡§Ç...",
                searching: "‡§∏‡§Æ‡§æ‡§ß‡§æ‡§® ‡§ñ‡•ã‡§ú‡§æ ‡§ú‡§æ ‡§∞‡§π‡§æ ‡§π‡•à... üîç",
                languageChanged: "‚úÖ ‡§≠‡§æ‡§∑‡§æ ‡§π‡§ø‡§Ç‡§¶‡•Ä ‡§Æ‡•á‡§Ç ‡§¨‡§¶‡§≤‡•Ä ‡§ó‡§à‡•§",
                voiceTooltip: "‡§®‡§Ø‡§æ! ‡§Ö‡§™‡§®‡•Ä ‡§Ü‡§µ‡§æ‡§ú ‡§∏‡•á ‡§∏‡§µ‡§æ‡§≤ ‡§™‡•Ç‡§õ‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è ‡§ü‡•à‡§™ ‡§ï‡§∞‡•á‡§Ç‡•§"
            },
             bn: {
                initialMessage: `<div class="message bot-message p-4 rounded-xl max-w-lg animate-slideIn">
                    <p class="font-bold text-gray-800">‡¶®‡¶Æ‡¶∏‡ßç‡¶ï‡¶æ‡¶∞, ‡¶Ü‡¶Æ‡¶ø ‡¶∏‡ßÅ‡¶∂‡ßç‡¶∞‡ßÅ‡¶§, ‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶è‡¶Ü‡¶á ‡¶∏‡ßç‡¶¨‡¶æ‡¶∏‡ßç‡¶•‡ßç‡¶Ø ‡¶∏‡¶π‡¶ï‡¶æ‡¶∞‡ßÄ! ü©∫</p>
                    <p class="text-sm text-gray-600 mt-1">‡¶Ü‡¶Æ‡¶ø ‡¶Ü‡¶™‡¶®‡¶æ‡¶ï‡ßá ‡¶∏‡¶æ‡¶π‡¶æ‡¶Ø‡ßç‡¶Ø ‡¶ï‡¶∞‡¶æ‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø ‡¶è‡¶ñ‡¶æ‡¶®‡ßá ‡¶Ü‡¶õ‡¶ø! üòä</p>
                    <p class="text-xs text-gray-400 mt-3 italic">‡¶Ö‡¶®‡ßÅ‡¶ó‡ßç‡¶∞‡¶π ‡¶ï‡¶∞‡ßá ‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶™‡ßç‡¶∞‡¶∂‡ßç‡¶® ‡¶ú‡¶ø‡¶ú‡ßç‡¶û‡¶æ‡¶∏‡¶æ ‡¶ï‡¶∞‡ßÅ‡¶® ‡¶¨‡¶æ ‡¶â‡¶™‡¶∞‡ßá‡¶∞ ‡¶¨‡ßã‡¶§‡¶æ‡¶Æ‡¶ó‡ßÅ‡¶≤‡¶ø ‡¶¨‡ßç‡¶Ø‡¶¨‡¶π‡¶æ‡¶∞ ‡¶ï‡¶∞‡ßÅ‡¶®‡•§</p>
                </div>`,
                placeholder: "‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶∏‡ßç‡¶¨‡¶æ‡¶∏‡ßç‡¶•‡ßç‡¶Ø ‡¶™‡ßç‡¶∞‡¶∂‡ßç‡¶® ‡¶è‡¶ñ‡¶æ‡¶®‡ßá ‡¶ü‡¶æ‡¶á‡¶™ ‡¶ï‡¶∞‡ßÅ‡¶®...",
                searching: "‡¶∏‡¶Æ‡¶æ‡¶ß‡¶æ‡¶® ‡¶ñ‡ßã‡¶Å‡¶ú‡¶æ ‡¶π‡¶ö‡ßç‡¶õ‡ßá... üîç",
                languageChanged: "‚úÖ ‡¶≠‡¶æ‡¶∑‡¶æ ‡¶¨‡¶æ‡¶Ç‡¶≤‡¶æ‡¶Ø‡¶º ‡¶™‡¶∞‡¶ø‡¶¨‡¶∞‡ßç‡¶§‡¶® ‡¶ï‡¶∞‡¶æ ‡¶π‡¶Ø‡¶º‡ßá‡¶õ‡ßá‡•§",
                voiceTooltip: "‡¶®‡¶§‡ßÅ‡¶®! ‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶≠‡¶Ø‡¶º‡ßá‡¶∏ ‡¶¶‡¶ø‡¶Ø‡¶º‡ßá ‡¶™‡ßç‡¶∞‡¶∂‡ßç‡¶® ‡¶ï‡¶∞‡¶§‡ßá ‡¶ü‡ßç‡¶Ø‡¶æ‡¶™ ‡¶ï‡¶∞‡ßÅ‡¶®‡•§"
            },
            ta: {
                initialMessage: `<div class="message bot-message p-4 rounded-xl max-w-lg animate-slideIn">
                    <p class="font-bold text-gray-800">‡Æµ‡Æ£‡Æï‡Øç‡Æï‡ÆÆ‡Øç, ‡Æ®‡Ææ‡Æ©‡Øç ‡Æö‡ØÅ‡Æ∑‡Øç‡Æ∞‡ØÅ‡Æ§‡Ææ, ‡Æâ‡Æô‡Øç‡Æï‡Æ≥‡Øç AI ‡Æö‡ØÅ‡Æï‡Ææ‡Æ§‡Ææ‡Æ∞ ‡Æâ‡Æ§‡Æµ‡Æø‡ÆØ‡Ææ‡Æ≥‡Æ∞‡Øç! ü©∫</p>
                    <p class="text-sm text-gray-600 mt-1">‡Æâ‡Æô‡Øç‡Æï‡Æ≥‡ØÅ‡Æï‡Øç‡Æï‡ØÅ ‡Æâ‡Æ§‡Æµ ‡Æ®‡Ææ‡Æ©‡Øç ‡Æá‡Æô‡Øç‡Æï‡Øá ‡Æá‡Æ∞‡ØÅ‡Æï‡Øç‡Æï‡Æø‡Æ±‡Øá‡Æ©‡Øç! üòä</p>
                    <p class="text-xs text-gray-400 mt-3 italic">‡Æâ‡Æô‡Øç‡Æï‡Æ≥‡Øç ‡Æï‡Øá‡Æ≥‡Øç‡Æµ‡Æø‡ÆØ‡Øà‡Æï‡Øç ‡Æï‡Øá‡Æü‡Øç‡Æï‡Æµ‡ØÅ‡ÆÆ‡Øç ‡ÆÖ‡Æ≤‡Øç‡Æ≤‡Æ§‡ØÅ ‡ÆÆ‡Øá‡Æ≤‡Øá ‡Æâ‡Æ≥‡Øç‡Æ≥ ‡Æ™‡Øä‡Æ§‡Øç‡Æ§‡Ææ‡Æ©‡Øç‡Æï‡Æ≥‡Øà‡Æ™‡Øç ‡Æ™‡ÆØ‡Æ©‡Øç‡Æ™‡Æü‡ØÅ‡Æ§‡Øç‡Æ§‡Æµ‡ØÅ‡ÆÆ‡Øç.</p>
                </div>`,
                placeholder: "‡Æâ‡Æô‡Øç‡Æï‡Æ≥‡Øç ‡Æö‡ØÅ‡Æï‡Ææ‡Æ§‡Ææ‡Æ∞ ‡Æï‡Øá‡Æ≥‡Øç‡Æµ‡Æø‡ÆØ‡Øà ‡Æá‡Æô‡Øç‡Æï‡Øá ‡Æ§‡Æü‡Øç‡Æü‡Æö‡Øç‡Æö‡ØÅ...",
                searching: "‡Æ§‡ØÄ‡Æ∞‡Øç‡Æµ‡ØÅ ‡Æ§‡Øá‡Æü‡Æ™‡Øç‡Æ™‡Æü‡ØÅ‡Æï‡Æø‡Æ±‡Æ§‡ØÅ... üîç",
                languageChanged: "‚úÖ ‡ÆÆ‡Øä‡Æ¥‡Æø ‡Æ§‡ÆÆ‡Æø‡Æ¥‡ØÅ‡Æï‡Øç‡Æï‡ØÅ ‡ÆÆ‡Ææ‡Æ±‡Øç‡Æ±‡Æ™‡Øç‡Æ™‡Æü‡Øç‡Æü‡ØÅ‡Æ≥‡Øç‡Æ≥‡Æ§‡ØÅ‡•§",
                voiceTooltip: "‡Æ™‡ØÅ‡Æ§‡Æø‡ÆØ‡Æ§‡ØÅ! ‡Æâ‡Æô‡Øç‡Æï‡Æ≥‡Øç ‡Æï‡ØÅ‡Æ∞‡Æ≤‡Æø‡Æ≤‡Øç ‡Æï‡Øá‡Æü‡Øç‡Æï ‡Æ§‡Æü‡Øç‡Æü‡Æµ‡ØÅ‡ÆÆ‡Øç."
            },
            od: {
                initialMessage: `<div class="message bot-message p-4 rounded-xl max-w-lg animate-slideIn">
                    <p class="font-bold text-gray-800">‡¨®‡¨Æ‡¨∏‡≠ç‡¨ï‡¨æ‡¨∞, ‡¨Æ‡≠Å‡¨Å ‡¨∏‡≠Å‡¨∂‡≠ç‡¨∞‡≠Å‡¨§, ‡¨Ü‡¨™‡¨£‡¨ô‡≠ç‡¨ï ‡¨è‡¨Ü‡¨á ‡¨∏‡≠ç‡≠±‡¨æ‡¨∏‡≠ç‡¨•‡≠ç‡≠ü ‡¨∏‡¨π‡¨æ‡≠ü‡¨ï! ü©∫</p>
                    <p class="text-sm text-gray-600 mt-1">‡¨Æ‡≠Å‡¨Å ‡¨Ü‡¨™‡¨£‡¨ô‡≠ç‡¨ï‡≠Å ‡¨∏‡¨æ‡¨π‡¨æ‡¨Ø‡≠ç‡≠ü ‡¨ï‡¨∞‡¨ø‡¨¨‡¨æ ‡¨™‡¨æ‡¨á‡¨Å ‡¨è‡¨†‡¨æ‡¨∞‡≠á ‡¨Ö‡¨õ‡¨ø! üòä</p>
                    <p class="text-xs text-gray-400 mt-3 italic">‡¨¶‡≠ü‡¨æ‡¨ï‡¨∞‡¨ø ‡¨Ü‡¨™‡¨£‡¨ô‡≠ç‡¨ï‡¨∞ ‡¨™‡≠ç‡¨∞‡¨∂‡≠ç‡¨® ‡¨™‡¨ö‡¨æ‡¨∞‡¨®‡≠ç‡¨§‡≠Å ‡¨ï‡¨ø‡¨Æ‡≠ç‡¨¨‡¨æ ‡¨â‡¨™‡¨∞ ‡¨¨‡¨ü‡¨®‡≠ç ‡¨¨‡≠ç‡≠ü‡¨¨‡¨π‡¨æ‡¨∞ ‡¨ï‡¨∞‡¨®‡≠ç‡¨§‡≠Å‡•§</p>
                </div>`,
                placeholder: "‡¨Ü‡¨™‡¨£‡¨ô‡≠ç‡¨ï ‡¨∏‡≠ç‡≠±‡¨æ‡¨∏‡≠ç‡¨•‡≠ç‡≠ü ‡¨™‡≠ç‡¨∞‡¨∂‡≠ç‡¨® ‡¨è‡¨†‡¨æ‡¨∞‡≠á ‡¨ü‡¨æ‡¨á‡¨™‡≠ç ‡¨ï‡¨∞‡¨®‡≠ç‡¨§‡≠Å...",
                searching: "‡¨∏‡¨Æ‡¨æ‡¨ß‡¨æ‡¨® ‡¨ñ‡≠ã‡¨ú‡¨æ‡¨Ø‡¨æ‡¨â‡¨õ‡¨ø... üîç",
                languageChanged: "‚úÖ ‡¨≠‡¨æ‡¨∑‡¨æ ‡¨ì‡¨°‡¨º‡¨ø‡¨Ü‡¨ï‡≠Å ‡¨¨‡¨¶‡¨≥‡¨æ‡¨ó‡¨≤‡¨æ‡•§",
                voiceTooltip: "‡¨®‡≠Ç‡¨Ü! ‡¨Ü‡¨™‡¨£‡¨ô‡≠ç‡¨ï ‡¨∏‡≠ç‡≠±‡¨∞‡¨∞‡≠á ‡¨™‡¨ö‡¨æ‡¨∞‡¨ø‡¨¨‡¨æ ‡¨™‡¨æ‡¨á‡¨Å ‡¨ü‡≠ç‡≠ü‡¨æ‡¨™‡≠ç ‡¨ï‡¨∞‡¨®‡≠ç‡¨§‡≠Å‡•§"
            }
        };


        // Pre-programmed knowledge base for quick-action buttons and specific queries
        const knowledgeBase = {
            womensHealth: {
                en: {
                    response: `üë©‚Äç‚öïÔ∏è <strong>Women's Health:</strong><br><br>
                    <div class="bg-pink-100 text-pink-800 p-4 rounded-lg my-2">
                        <strong class="font-semibold">Common topics:</strong><br>
                        <ul><li><strong>Menstrual Health:</strong> Irregular periods, heavy bleeding, or severe pain should be discussed with a doctor.</li>
                        <li><strong>PCOS:</strong> Polycystic Ovary Syndrome symptoms include irregular periods, excess hair growth, and weight gain.</li>
                        <li><strong>UTIs:</strong> Urinary Tract Infections are common; symptoms include painful urination and frequent urges.</li></ul>
                        <br><br>
                        <strong class="font-semibold text-red-600">‚ö†Ô∏è Disclaimer:</strong> For a proper diagnosis and treatment plan, it is crucial to consult a Gynecologist or a General Physician.
                    </div>`,
                    keywords: ['women\'s health', 'women', 'menstrual', 'pcos', 'uti', 'female health']
                },
                hi: {
                    response: `üë©‚Äç‚öïÔ∏è <strong>‡§Æ‡§π‡§ø‡§≤‡§æ ‡§∏‡•ç‡§µ‡§æ‡§∏‡•ç‡§•‡•ç‡§Ø:</strong><br><br>
                    <div class="bg-pink-100 text-pink-800 p-4 rounded-lg my-2">
                        <strong class="font-semibold">‡§∏‡§æ‡§Æ‡§æ‡§®‡•ç‡§Ø ‡§µ‡§ø‡§∑‡§Ø:</strong><br>
                        <ul><li><strong>‡§Æ‡§æ‡§∏‡§ø‡§ï ‡§ß‡§∞‡•ç‡§Æ ‡§∏‡•ç‡§µ‡§æ‡§∏‡•ç‡§•‡•ç‡§Ø:</strong> ‡§Ö‡§®‡§ø‡§Ø‡§Æ‡§ø‡§§ ‡§™‡•Ä‡§∞‡§ø‡§Ø‡§°‡•ç‡§∏, ‡§ú‡•ç‡§Ø‡§æ‡§¶‡§æ ‡§¨‡•ç‡§≤‡•Ä‡§°‡§ø‡§Ç‡§ó, ‡§Ø‡§æ ‡§§‡•á‡§ú ‡§¶‡§∞‡•ç‡§¶ ‡§π‡•ã‡§®‡•á ‡§™‡§∞ ‡§°‡•â‡§ï‡•ç‡§ü‡§∞ ‡§∏‡•á ‡§∏‡§≤‡§æ‡§π ‡§≤‡•á‡§Ç‡•§</li>
                        <li><strong>PCOS:</strong> ‡§™‡•â‡§≤‡•Ä‡§∏‡§ø‡§∏‡•ç‡§ü‡§ø‡§ï ‡§ì‡§µ‡§∞‡•Ä ‡§∏‡§ø‡§Ç‡§°‡•ç‡§∞‡•ã‡§Æ ‡§ï‡•á ‡§≤‡§ï‡•ç‡§∑‡§£‡•ã‡§Ç ‡§Æ‡•á‡§Ç ‡§Ö‡§®‡§ø‡§Ø‡§Æ‡§ø‡§§ ‡§™‡•Ä‡§∞‡§ø‡§Ø‡§°‡•ç‡§∏, ‡§Ö‡§§‡§ø‡§∞‡§ø‡§ï‡•ç‡§§ ‡§¨‡§æ‡§≤ ‡§â‡§ó‡§®‡§æ ‡§î‡§∞ ‡§µ‡§ú‡§® ‡§¨‡§¢‡§º‡§®‡§æ ‡§∂‡§æ‡§Æ‡§ø‡§≤ ‡§π‡•à‡•§</li>
                        <li><strong>UTIs:</strong> ‡§Ø‡•Ç‡§∞‡§ø‡§®‡§∞‡•Ä ‡§ü‡•ç‡§∞‡•à‡§ï‡•ç‡§ü ‡§á‡§®‡•ç‡§´‡•á‡§ï‡•ç‡§∂‡§® ‡§Ü‡§Æ ‡§π‡•à‡§Ç; ‡§≤‡§ï‡•ç‡§∑‡§£‡•ã‡§Ç ‡§Æ‡•á‡§Ç ‡§™‡•á‡§∂‡§æ‡§¨ ‡§ï‡§∞‡§§‡•á ‡§∏‡§Æ‡§Ø ‡§¶‡§∞‡•ç‡§¶ ‡§î‡§∞ ‡§¨‡§æ‡§∞-‡§¨‡§æ‡§∞ ‡§™‡•á‡§∂‡§æ‡§¨ ‡§ï‡§æ ‡§Ü‡§ó‡•ç‡§∞‡§π ‡§∂‡§æ‡§Æ‡§ø‡§≤ ‡§π‡•à‡•§</li></ul>
                        <br><br>
                        <strong class="font-semibold text-red-600">‚ö†Ô∏è ‡§ö‡•á‡§§‡§æ‡§µ‡§®‡•Ä:</strong> ‡§∏‡§ü‡•Ä‡§ï ‡§®‡§ø‡§¶‡§æ‡§® ‡§î‡§∞ ‡§â‡§™‡§ö‡§æ‡§∞ ‡§Ø‡•ã‡§ú‡§®‡§æ ‡§ï‡•á ‡§≤‡§ø‡§è, ‡§∏‡•ç‡§§‡•ç‡§∞‡•Ä ‡§∞‡•ã‡§ó ‡§µ‡§ø‡§∂‡•á‡§∑‡§ú‡•ç‡§û ‡§Ø‡§æ ‡§∏‡§æ‡§Æ‡§æ‡§®‡•ç‡§Ø ‡§ö‡§ø‡§ï‡§ø‡§§‡•ç‡§∏‡§ï ‡§∏‡•á ‡§™‡§∞‡§æ‡§Æ‡§∞‡•ç‡§∂ ‡§ï‡§∞‡§®‡§æ ‡§Æ‡§π‡§§‡•ç‡§µ‡§™‡•Ç‡§∞‡•ç‡§£ ‡§π‡•à‡•§
                    </div>`,
                    keywords: ['‡§Æ‡§π‡§ø‡§≤‡§æ ‡§∏‡•ç‡§µ‡§æ‡§∏‡•ç‡§•‡•ç‡§Ø', '‡§Æ‡§π‡§ø‡§≤‡§æ', '‡§Æ‡§æ‡§∏‡§ø‡§ï ‡§ß‡§∞‡•ç‡§Æ', '‡§™‡•â‡§≤‡•Ä‡§∏‡§ø‡§∏‡•ç‡§ü‡§ø‡§ï', '‡§™‡•Ä.‡§∏‡•Ä.‡§ì.‡§è‡§∏.', '‡§Ø‡•Ç‡§ü‡•Ä‡§Ü‡§à']
                },
                od: {
                    response: `üë©‚Äç‚öïÔ∏è <strong>‡¨Æ‡¨π‡¨ø‡¨≥‡¨æ‡¨ô‡≠ç‡¨ï ‡¨∏‡≠ç‡≠±‡¨æ‡¨∏‡≠ç‡¨•‡≠ç‡≠ü:</strong><br><br>
                    <div class="bg-pink-100 text-pink-800 p-4 rounded-lg my-2">
                        <strong class="font-semibold">‡¨∏‡¨æ‡¨ß‡¨æ‡¨∞‡¨£ ‡¨¨‡¨ø‡¨∑‡≠ü:</strong><br>
                        <ul><li><strong>‡¨Æ‡¨æ‡¨∏‡¨ø‡¨ï ‡¨ß‡¨∞‡≠ç‡¨Æ ‡¨∏‡≠ç‡≠±‡¨æ‡¨∏‡≠ç‡¨•‡≠ç‡≠ü:</strong> ‡¨Ö‡¨®‡¨ø‡≠ü‡¨Æ‡¨ø‡¨§ ‡¨™‡¨ø‡¨∞‡¨ø‡¨Ö‡¨°‡≠ç, ‡¨Ö‡¨ß‡¨ø‡¨ï ‡¨∞‡¨ï‡≠ç‡¨§‡¨∏‡≠ç‡¨∞‡¨æ‡¨¨, ‡¨ï‡¨ø‡¨Æ‡≠ç‡¨¨‡¨æ ‡¨ó‡≠Å‡¨∞‡≠Å‡¨§‡¨∞ ‡¨Ø‡¨®‡≠ç‡¨§‡≠ç‡¨∞‡¨£‡¨æ ‡¨π‡≠á‡¨≤‡≠á ‡¨°‡¨æ‡¨ï‡≠ç‡¨§‡¨∞‡¨ô‡≠ç‡¨ï ‡¨∏‡¨π‡¨ø‡¨§ ‡¨™‡¨∞‡¨æ‡¨Æ‡¨∞‡≠ç‡¨∂ ‡¨ï‡¨∞‡¨ø‡¨¨‡¨æ ‡¨â‡¨ö‡¨ø‡¨§‡≠ç‡•§</li>
                        <li><strong>PCOS:</strong> ‡¨™‡¨≤‡¨ø‡¨∏‡¨ø‡¨∑‡≠ç‡¨ü‡¨ø‡¨ï‡≠ç ‡¨ì‡¨≠‡¨æ‡¨∞‡≠Ä ‡¨∏‡¨ø‡¨£‡≠ç‡¨°‡≠ç‡¨∞‡≠ã‡¨Æ‡¨∞ ‡¨≤‡¨ï‡≠ç‡¨∑‡¨£‡¨ó‡≠Å‡¨°‡¨º‡¨ø‡¨ï‡¨∞‡≠á ‡¨Ö‡¨®‡¨ø‡≠ü‡¨Æ‡¨ø‡¨§ ‡¨™‡¨ø‡¨∞‡¨ø‡¨Ö‡¨°‡≠ç, ‡¨Ö‡¨§‡≠ç‡≠ü‡¨ß‡¨ø‡¨ï ‡¨ï‡≠á‡¨∂ ‡¨¨‡≠É‡¨¶‡≠ç‡¨ß‡¨ø ‡¨è‡¨¨‡¨Ç ‡¨ì‡¨ú‡¨® ‡¨¨‡≠É‡¨¶‡≠ç‡¨ß‡¨ø ‡¨∏‡¨æ‡¨Æ‡¨ø‡¨≤‡≠ç‡•§</li>
                        <li><strong>UTIs:</strong> ‡¨Æ‡≠Ç‡¨§‡≠ç‡¨∞‡¨æ‡¨∂‡≠ü ‡¨∏‡¨Ç‡¨ï‡≠ç‡¨∞‡¨Æ‡¨£ ‡¨∏‡¨æ‡¨ß‡¨æ‡¨∞‡¨£ ‡¨Ö‡¨ü‡≠á; ‡¨≤‡¨ï‡≠ç‡¨∑‡¨£‡¨ó‡≠Å‡¨°‡¨º‡¨ø‡¨ï‡¨∞‡≠á ‡¨Ø‡¨®‡≠ç‡¨§‡≠ç‡¨∞‡¨£‡¨æ‡¨¶‡¨æ‡≠ü‡¨ï ‡¨Æ‡≠Ç‡¨§‡≠ç‡¨∞‡¨§‡≠ç‡≠ü‡¨æ‡¨ó ‡¨è‡¨¨‡¨Ç ‡¨¨‡¨æ‡¨∞‡¨Æ‡≠ç‡¨¨‡¨æ‡¨∞ ‡¨Æ‡≠Ç‡¨§‡≠ç‡¨∞‡¨§‡≠ç‡≠ü‡¨æ‡¨ó ‡¨ï‡¨∞‡¨ø‡¨¨‡¨æ‡¨∞ ‡¨á‡¨ö‡≠ç‡¨õ‡¨æ ‡¨Ö‡¨®‡≠ç‡¨§‡¨∞‡≠ç‡¨≠‡≠Å‡¨ï‡≠ç‡¨§‡•§</li></ul>
                        <br><br>
                        <strong class="font-semibold text-red-600">‚ö†Ô∏è ‡¨∏‡¨§‡¨∞‡≠ç‡¨ï‡¨§‡¨æ:</strong> ‡¨∏‡¨†‡¨ø‡¨ï‡≠ç ‡¨∞‡≠ã‡¨ó ‡¨®‡¨ø‡¨∞‡≠ç‡¨£‡≠ç‡¨£‡≠ü ‡¨è‡¨¨‡¨Ç ‡¨ö‡¨ø‡¨ï‡¨ø‡¨§‡≠ç‡¨∏‡¨æ ‡¨™‡¨æ‡¨á‡¨Å, ‡¨ú‡¨£‡≠á ‡¨∏‡≠ç‡¨§‡≠ç‡¨∞‡≠Ä ‡¨∞‡≠ã‡¨ó ‡¨¨‡¨ø‡¨∂‡≠á‡¨∑‡¨ú‡≠ç‡¨û ‡¨ï‡¨ø‡¨Æ‡≠ç‡¨¨‡¨æ ‡¨ú‡¨£‡≠á ‡¨∏‡¨æ‡¨ß‡¨æ‡¨∞‡¨£ ‡¨ö‡¨ø‡¨ï‡¨ø‡¨§‡≠ç‡¨∏‡¨ï‡¨ô‡≠ç‡¨ï ‡¨∏‡¨π‡¨ø‡¨§ ‡¨™‡¨∞‡¨æ‡¨Æ‡¨∞‡≠ç‡¨∂ ‡¨ï‡¨∞‡¨ø‡¨¨‡¨æ ‡¨Ö‡¨§‡≠ç‡≠ü‡¨®‡≠ç‡¨§ ‡¨ó‡≠Å‡¨∞‡≠Å‡¨§‡≠ç‡≠±‡¨™‡≠Ç‡¨∞‡≠ç‡¨£‡≠ç‡¨£‡•§
                    </div>`,
                    keywords: ['‡¨Æ‡¨π‡¨ø‡¨≥‡¨æ ‡¨∏‡≠ç‡≠±‡¨æ‡¨∏‡≠ç‡¨•‡≠ç‡≠ü', '‡¨Æ‡¨π‡¨ø‡¨≥‡¨æ', '‡¨Æ‡¨æ‡¨∏‡¨ø‡¨ï ‡¨ß‡¨∞‡≠ç‡¨Æ', '‡¨™‡¨ø.‡¨∏‡¨ø.‡¨ì.‡¨è‡¨∏', '‡≠ü‡≠Å.‡¨ü‡¨ø.‡¨Ü‡¨á']
                }
            },
            diseaseOutbreaks: {
                en: { keywords: ['disease outbreaks', 'outbreak', 'alerts', 'advisory', 'disease', 'diseases'] },
                hi: { keywords: ['‡§∞‡•ã‡§ó ‡§™‡•ç‡§∞‡§ï‡•ã‡§™', '‡§™‡•ç‡§∞‡§ï‡•ã‡§™', '‡§Ö‡§≤‡§∞‡•ç‡§ü', '‡§∏‡§≤‡§æ‡§π', '‡§∞‡•ã‡§ó', '‡§¨‡•Ä‡§Æ‡§æ‡§∞‡•Ä'] },
                od: { keywords: ['‡¨∞‡≠ã‡¨ó ‡¨™‡≠ç‡¨∞‡¨ï‡≠ã‡¨™', '‡¨™‡≠ç‡¨∞‡¨ï‡≠ã‡¨™', '‡¨∏‡¨§‡¨∞‡≠ç‡¨ï‡¨§‡¨æ', '‡¨∞‡≠ã‡¨ó'] }
            },
            govtHospitals: {
                en: {
                    response: `üè• <strong>Government Hospitals in India:</strong><br><br>
                    <div class="bg-cyan-100 text-cyan-800 p-4 rounded-lg my-2">
                        <p>Finding a government hospital is a great way to access affordable healthcare. Don't worry, we can help you with that! üòä</p>
                        <br>
                        <p>To give you the most accurate list, please tell me which city you are looking for hospitals in. For example, you can type "<strong>Government hospitals in Noida</strong>".</p>
                    </div>`,
                    keywords: ['government hospital', 'govt hospital', 'sarkari hospital', 'government clinic', '‡§∏‡§∞‡§ï‡§æ‡§∞‡•Ä ‡§Ö‡§∏‡•ç‡§™‡§§‡§æ‡§≤', '‡§∏‡§∞‡§ï‡§æ‡§∞‡•Ä ‡§ï‡•ç‡§≤‡§ø‡§®‡§ø‡§ï']
                },
                hi: {
                    response: `üè• <strong>‡§≠‡§æ‡§∞‡§§ ‡§Æ‡•á‡§Ç ‡§∏‡§∞‡§ï‡§æ‡§∞‡•Ä ‡§Ö‡§∏‡•ç‡§™‡§§‡§æ‡§≤:</strong><br><br>
                    <div class="bg-cyan-100 text-cyan-800 p-4 rounded-lg my-2">
                        <p>‡§∏‡§∞‡§ï‡§æ‡§∞‡•Ä ‡§Ö‡§∏‡•ç‡§™‡§§‡§æ‡§≤ ‡§¢‡•Ç‡§Ç‡§¢‡§®‡§æ ‡§ï‡§ø‡§´‡§æ‡§Ø‡§§‡•Ä ‡§∏‡•ç‡§µ‡§æ‡§∏‡•ç‡§•‡•ç‡§Ø ‡§∏‡•á‡§µ‡§æ ‡§™‡§æ‡§®‡•á ‡§ï‡§æ ‡§è‡§ï ‡§∂‡§æ‡§®‡§¶‡§æ‡§∞ ‡§§‡§∞‡•Ä‡§ï‡§æ ‡§π‡•à‡•§ ‡§ö‡§ø‡§Ç‡§§‡§æ ‡§® ‡§ï‡§∞‡•á‡§Ç, ‡§π‡§Æ ‡§á‡§∏‡§Æ‡•á‡§Ç ‡§Ü‡§™‡§ï‡•Ä ‡§Æ‡§¶‡§¶ ‡§ï‡§∞ ‡§∏‡§ï‡§§‡•á ‡§π‡•à‡§Ç! üòä</p>
                        <br>
                        <p>‡§∏‡§¨‡§∏‡•á ‡§∏‡§ü‡•Ä‡§ï ‡§∏‡•Ç‡§ö‡•Ä ‡§¶‡•á‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è, ‡§ï‡•É‡§™‡§Ø‡§æ ‡§Æ‡•Å‡§ù‡•á ‡§¨‡§§‡§æ‡§è‡§Ç ‡§ï‡§ø ‡§Ü‡§™ ‡§ï‡§ø‡§∏ ‡§∂‡§π‡§∞ ‡§Æ‡•á‡§Ç ‡§Ö‡§∏‡•ç‡§™‡§§‡§æ‡§≤ ‡§ñ‡•ã‡§ú ‡§∞‡§π‡•á ‡§π‡•à‡§Ç‡•§ ‡§â‡§¶‡§æ‡§π‡§∞‡§£ ‡§ï‡•á ‡§≤‡§ø‡§è, ‡§Ü‡§™ "<strong>‡§®‡•ã‡§è‡§°‡§æ ‡§Æ‡•á‡§Ç ‡§∏‡§∞‡§ï‡§æ‡§∞‡•Ä ‡§Ö‡§∏‡•ç‡§™‡§§‡§æ‡§≤</strong>" ‡§ü‡§æ‡§á‡§™ ‡§ï‡§∞ ‡§∏‡§ï‡§§‡•á ‡§π‡•à‡§Ç‡•§</p>
                    </div>`,
                    keywords: ['‡§∏‡§∞‡§ï‡§æ‡§∞‡•Ä ‡§Ö‡§∏‡•ç‡§™‡§§‡§æ‡§≤', '‡§∏‡§∞‡§ï‡§æ‡§∞‡•Ä ‡§ï‡•ç‡§≤‡§ø‡§®‡§ø‡§ï', '‡§∏‡§∞‡§ï‡§æ‡§∞‡•Ä ‡§°‡•â‡§ï‡•ç‡§ü‡§∞', '‡§∏‡§∞‡§ï‡§æ‡§∞‡•Ä ‡§ï‡•ç‡§≤‡§ø‡§®‡§ø‡§ï']
                },
                od: {
                    response: `üè• <strong>‡¨≠‡¨æ‡¨∞‡¨§‡¨∞‡≠á ‡¨∏‡¨∞‡¨ï‡¨æ‡¨∞‡≠Ä ‡¨°‡¨æ‡¨ï‡≠ç‡¨§‡¨∞‡¨ñ‡¨æ‡¨®‡¨æ:</strong><br><br>
                    <div class="bg-cyan-100 text-cyan-800 p-4 rounded-lg my-2">
                        <p>‡¨∏‡¨∞‡¨ï‡¨æ‡¨∞‡≠Ä ‡¨°‡¨æ‡¨ï‡≠ç‡¨§‡¨∞‡¨ñ‡¨æ‡¨®‡¨æ ‡¨ñ‡≠ã‡¨ú‡¨ø‡¨¨‡¨æ ‡¨π‡≠á‡¨â‡¨õ‡¨ø ‡¨ï‡¨Æ‡≠ç ‡¨ñ‡¨∞‡≠ç‡¨ö‡≠ç‡¨ö‡¨∞‡≠á ‡¨∏‡≠ç‡≠±‡¨æ‡¨∏‡≠ç‡¨•‡≠ç‡≠ü ‡¨∏‡≠á‡¨¨‡¨æ ‡¨™‡¨æ‡¨á‡¨¨‡¨æ ‡¨™‡¨æ‡¨á‡¨Å ‡¨è‡¨ï ‡¨â‡¨§‡≠ç‡¨ï‡≠É‡¨∑‡≠ç‡¨ü ‡¨â‡¨™‡¨æ‡≠ü‡•§ ‡¨ö‡¨ø‡¨®‡≠ç‡¨§‡¨æ ‡¨ï‡¨∞‡¨®‡≠ç‡¨§‡≠Å ‡¨®‡¨æ‡¨π‡¨ø‡¨Å, ‡¨Ü‡¨Æ‡≠á ‡¨è‡¨•‡¨ø‡¨∞‡≠á ‡¨Ü‡¨™‡¨£‡¨ô‡≠ç‡¨ï‡≠Å ‡¨∏‡¨æ‡¨π‡¨æ‡¨Ø‡≠ç‡≠ü ‡¨ï‡¨∞‡¨ø‡¨™‡¨æ‡¨∞‡¨ø‡¨¨‡≠Å! üòä</p>
                        <br>
                        <p>‡¨∏‡¨¨‡≠Å‡¨†‡¨æ‡¨∞‡≠Å ‡¨®‡¨ø‡¨ï‡¨ü‡¨§‡¨Æ ‡¨∏‡¨∞‡¨ï‡¨æ‡¨∞‡≠Ä ‡¨°‡¨æ‡¨ï‡≠ç‡¨§‡¨∞‡¨ñ‡¨æ‡¨®‡¨æ ‡¨ñ‡≠ã‡¨ú‡¨ø‡¨¨‡¨æ ‡¨™‡¨æ‡¨á‡¨Å, ‡¨Ü‡¨™‡¨£ ‡¨ï‡≠á‡¨â‡¨Å ‡¨∏‡¨π‡¨∞‡¨∞‡≠á ‡¨Ö‡¨õ‡¨®‡≠ç‡¨§‡¨ø ‡¨§‡¨æ‡¨π‡¨æ ‡¨ï‡≠Å‡¨π‡¨®‡≠ç‡¨§‡≠Å‡•§ ‡¨â‡¨¶‡¨æ‡¨π‡¨∞‡¨£ ‡¨∏‡≠ç‡≠±‡¨∞‡≠Ç‡¨™, ‡¨Ü‡¨™‡¨£ "<strong>‡¨®‡≠ã‡¨á‡¨°‡¨æ‡¨∞‡≠á ‡¨∏‡¨∞‡¨ï‡¨æ‡¨∞‡≠Ä ‡¨°‡¨æ‡¨ï‡≠ç‡¨§‡¨∞‡¨ñ‡¨æ‡¨®‡¨æ</strong>" ‡¨ü‡¨æ‡¨á‡¨™‡≠ç ‡¨ï‡¨∞‡¨ø‡¨™‡¨æ‡¨∞‡¨ø‡¨¨‡≠á‡•§</p>
                    </div>`,
                    keywords: ['‡¨∏‡¨∞‡¨ï‡¨æ‡¨∞‡≠Ä ‡¨°‡¨æ‡¨ï‡≠ç‡¨§‡¨∞‡¨ñ‡¨æ‡¨®‡¨æ', '‡¨∏‡¨∞‡¨ï‡¨æ‡¨∞‡≠Ä ‡¨ï‡≠ç‡¨≤‡¨ø‡¨®‡¨ø‡¨ï‡≠ç', '‡¨°‡¨æ‡¨ï‡≠ç‡¨§‡¨∞‡¨ñ‡¨æ‡¨®‡¨æ', '‡¨ï‡≠ç‡¨≤‡¨ø‡¨®‡¨ø‡¨ï‡≠ç']
                }
            },
            importantCityHospitals: {
                 noida: {
                    en: `Don't worry, here is a list of some government hospitals in <strong>Noida</strong>: üòä
                    <ul>
                        <li><strong>District Government Hospital, Sector 30</strong><br>Address: Sector 30, Noida, Uttar Pradesh 201301</li>
                        <li><strong>Government Institute of Medical Sciences (GIMS)</strong><br>Address: Greater Noida, Uttar Pradesh 201310</li>
                        <li><strong>ESIC Model Hospital</strong><br>Address: Sector 24, Noida, Uttar Pradesh 201301</li>
                    </ul>`,
                    hi: `‡§ö‡§ø‡§Ç‡§§‡§æ ‡§® ‡§ï‡§∞‡•á‡§Ç, <strong>‡§®‡•ã‡§è‡§°‡§æ</strong> ‡§Æ‡•á‡§Ç ‡§ï‡•Å‡§õ ‡§∏‡§∞‡§ï‡§æ‡§∞‡•Ä ‡§Ö‡§∏‡•ç‡§™‡§§‡§æ‡§≤‡•ã‡§Ç ‡§ï‡•Ä ‡§∏‡•Ç‡§ö‡•Ä ‡§Ø‡§π‡§æ‡§Å ‡§¶‡•Ä ‡§ó‡§à ‡§π‡•à: üòä
                    <ul>
                        <li><strong>‡§ú‡§ø‡§≤‡§æ ‡§∏‡§∞‡§ï‡§æ‡§∞‡•Ä ‡§Ö‡§∏‡•ç‡§™‡§§‡§æ‡§≤, ‡§∏‡•á‡§ï‡•ç‡§ü‡§∞ 30</strong><br>‡§™‡§§‡§æ: ‡§∏‡•á‡§ï‡•ç‡§ü‡§∞ 30, ‡§®‡•ã‡§è‡§°‡§æ, ‡§â‡§§‡•ç‡§§‡§∞ ‡§™‡•ç‡§∞‡§¶‡•á‡§∂ 201301</li>
                        <li><strong>‡§∂‡§æ‡§∏‡§ï‡•Ä‡§Ø ‡§Ü‡§Ø‡•Å‡§∞‡•ç‡§µ‡§ø‡§ú‡•ç‡§û‡§æ‡§® ‡§∏‡§Ç‡§∏‡•ç‡§•‡§æ‡§® (GIMS)</strong><br>‡§™‡§§‡§æ: ‡§ó‡•ç‡§∞‡•á‡§ü‡§∞ ‡§®‡•ã‡§è‡§°‡§æ, ‡§â‡§§‡•ç‡§§‡§∞ ‡§™‡•ç‡§∞‡§¶‡•á‡§∂ 201310</li>
                        <li><strong>‡§à‡§è‡§∏‡§Ü‡§à‡§∏‡•Ä ‡§Æ‡•â‡§°‡§≤ ‡§Ö‡§∏‡•ç‡§™‡§§‡§æ‡§≤</strong><br>‡§™‡§§‡§æ: ‡§∏‡•á‡§ï‡•ç‡§ü‡§∞ 24, ‡§®‡•ã‡§è‡§°‡§æ, ‡§â‡§§‡•ç‡§§‡§∞ ‡§™‡•ç‡§∞‡§¶‡•á‡§∂ 201301</li>
                    </ul>`,
                    od: `‡¨ö‡¨ø‡¨®‡≠ç‡¨§‡¨æ ‡¨ï‡¨∞‡¨®‡≠ç‡¨§‡≠Å ‡¨®‡¨æ‡¨π‡¨ø‡¨Å, <strong>‡¨®‡≠ã‡¨á‡¨°‡¨æ</strong>‡¨∞‡≠á ‡¨ï‡¨ø‡¨õ‡¨ø ‡¨∏‡¨∞‡¨ï‡¨æ‡¨∞‡≠Ä ‡¨°‡¨æ‡¨ï‡≠ç‡¨§‡¨∞‡¨ñ‡¨æ‡¨®‡¨æ‡¨∞ ‡¨§‡¨æ‡¨≤‡¨ø‡¨ï‡¨æ ‡¨è‡¨†‡¨æ‡¨∞‡≠á ‡¨¶‡¨ø‡¨Ü‡¨Ø‡¨æ‡¨á‡¨õ‡¨ø: üòä
                    <ul>
                        <li><strong>‡¨ú‡¨ø‡¨≤‡≠ç‡¨≤‡¨æ ‡¨∏‡¨∞‡¨ï‡¨æ‡¨∞‡≠Ä ‡¨°‡¨æ‡¨ï‡≠ç‡¨§‡¨∞‡¨ñ‡¨æ‡¨®‡¨æ, ‡¨∏‡≠á‡¨ï‡≠ç‡¨ü‡¨∞ 30</strong><br>‡¨†‡¨ø‡¨ï‡¨£‡¨æ: ‡¨∏‡≠á‡¨ï‡≠ç‡¨ü‡¨∞ 30, ‡¨®‡≠ã‡¨á‡¨°‡¨æ, ‡¨â‡¨§‡≠ç‡¨§‡¨∞ ‡¨™‡≠ç‡¨∞‡¨¶‡≠á‡¨∂ 201301</li>
                        <li><strong>‡¨∏‡¨∞‡¨ï‡¨æ‡¨∞‡≠Ä ‡¨Ü‡≠ü‡≠Å‡¨∞‡≠ç‡¨¨‡¨ø‡¨ú‡≠ç‡¨û‡¨æ‡¨® ‡¨∏‡¨Ç‡¨∏‡≠ç‡¨•‡¨æ‡¨® (GIMS)</strong><br>‡¨†‡¨ø‡¨ï‡¨£‡¨æ: ‡¨ó‡≠ç‡¨∞‡≠á‡¨ü‡¨∞ ‡¨®‡≠ã‡¨á‡¨°‡¨æ, ‡¨â‡¨§‡≠ç‡¨§‡¨∞ ‡¨™‡≠ç‡¨∞‡¨¶‡≠á‡¨∂ 201310</li>
                        <li><strong>ESIC ‡¨Æ‡¨°‡≠á‡¨≤‡≠ç ‡¨π‡¨∏‡≠ç‡¨™‡¨ø‡¨ü‡¨æ‡¨≤‡≠ç</strong><br>‡¨†‡¨ø‡¨ï‡¨£‡¨æ: ‡¨∏‡≠á‡¨ï‡≠ç‡¨ü‡¨∞ 24, ‡¨®‡≠ã‡¨á‡¨°‡¨æ, ‡¨â‡¨§‡≠ç‡¨§‡¨∞ ‡¨™‡≠ç‡¨∞‡¨¶‡≠á‡¨∂ 201301</li>
                    </ul>`
                }
            }
        };

        const criticalResponses = {
            en: `üö® <strong>Urgent Medical Alert!</strong><br><br>
            <div class="bg-red-100 text-red-800 p-4 rounded-lg my-2">
                <p><strong>Please seek immediate medical attention.</strong></p>
                <p>Call the National Emergency Number <strong>112</strong> or an ambulance at <strong>108</strong>.</p>
                <p class="mt-2">For accurate medical advice, please consult a professional immediately.</p>
            </div>`,
            hi: `üö® <strong>‡§Ü‡§™‡§æ‡§§‡§ï‡§æ‡§≤‡•Ä‡§® ‡§ö‡§ø‡§ï‡§ø‡§§‡•ç‡§∏‡§æ ‡§ö‡•á‡§§‡§æ‡§µ‡§®‡•Ä!</strong><br><br>
            <div class="bg-red-100 text-red-800 p-4 rounded-lg my-2">
                <p><strong>‡§ï‡•É‡§™‡§Ø‡§æ ‡§§‡•Å‡§∞‡§Ç‡§§ ‡§ö‡§ø‡§ï‡§ø‡§§‡•ç‡§∏‡§æ ‡§∏‡§π‡§æ‡§Ø‡§§‡§æ ‡§≤‡•á‡§Ç‡•§</strong></p>
                <p>‡§∞‡§æ‡§∑‡•ç‡§ü‡•ç‡§∞‡•Ä‡§Ø ‡§Ü‡§™‡§æ‡§§‡§ï‡§æ‡§≤‡•Ä‡§® ‡§®‡§Ç‡§¨‡§∞ <strong>112</strong> ‡§Ø‡§æ ‡§è‡§Æ‡•ç‡§¨‡•Å‡§≤‡•á‡§Ç‡§∏ ‡§ï‡•ã <strong>108</strong> ‡§™‡§∞ ‡§ï‡•â‡§≤ ‡§ï‡§∞‡•á‡§Ç‡•§</p>
                <p class="mt-2">‡§∏‡§ü‡•Ä‡§ï ‡§ö‡§ø‡§ï‡§ø‡§§‡•ç‡§∏‡§æ ‡§∏‡§≤‡§æ‡§π ‡§ï‡•á ‡§≤‡§ø‡§è, ‡§ï‡•É‡§™‡§Ø‡§æ ‡§§‡•Å‡§∞‡§Ç‡§§ ‡§ï‡§ø‡§∏‡•Ä ‡§™‡•á‡§∂‡•á‡§µ‡§∞ ‡§∏‡•á ‡§™‡§∞‡§æ‡§Æ‡§∞‡•ç‡§∂ ‡§ï‡§∞‡•á‡§Ç‡•§</p>
            </div>`,
            od: `üö® <strong>‡¨ú‡¨∞‡≠Å‡¨∞‡≠Ä‡¨ï‡¨æ‡¨≥‡≠Ä‡¨® ‡¨°‡¨æ‡¨ï‡≠ç‡¨§‡¨∞‡≠Ä ‡¨∏‡¨§‡¨∞‡≠ç‡¨ï‡¨§‡¨æ!</strong><br><br>
            <div class="bg-red-100 text-red-800 p-4 rounded-lg my-2">
                <p><strong>‡¨¶‡≠ü‡¨æ‡¨ï‡¨∞‡¨ø ‡¨§‡≠Å‡¨∞‡¨®‡≠ç‡¨§ ‡¨°‡¨æ‡¨ï‡≠ç‡¨§‡¨∞‡≠Ä ‡¨∏‡¨π‡¨æ‡≠ü‡¨§‡¨æ ‡¨≤‡≠ã‡¨°‡¨º‡¨®‡≠ç‡¨§‡≠Å‡•§</strong></p>
                <p>‡¨ú‡¨æ‡¨§‡≠Ä‡≠ü ‡¨ú‡¨∞‡≠Å‡¨∞‡≠Ä‡¨ï‡¨æ‡¨≥‡≠Ä‡¨® ‡¨®‡¨Æ‡≠ç‡¨¨‡¨∞ <strong>112</strong> ‡¨ï‡≠Å ‡¨ï‡¨≤‡≠ç ‡¨ï‡¨∞‡¨®‡≠ç‡¨§‡≠Å ‡¨ï‡¨ø‡¨Æ‡≠ç‡¨¨‡¨æ ‡¨Ü‡¨Æ‡≠ç‡¨¨‡≠Å‡¨≤‡¨æ‡¨®‡≠ç‡¨∏ ‡¨™‡¨æ‡¨á‡¨Å <strong>108</strong> ‡¨ï‡≠Å ‡¨ï‡¨≤‡≠ç ‡¨ï‡¨∞‡¨®‡≠ç‡¨§‡≠Å‡•§</p>
                <p class="mt-2">‡¨∏‡¨†‡¨ø‡¨ï‡≠ç ‡¨°‡¨æ‡¨ï‡≠ç‡¨§‡¨∞‡≠Ä ‡¨™‡¨∞‡¨æ‡¨Æ‡¨∞‡≠ç‡¨∂ ‡¨™‡¨æ‡¨á‡¨Å, ‡¨¶‡≠ü‡¨æ‡¨ï‡¨∞‡¨ø ‡¨§‡≠Å‡¨∞‡¨®‡≠ç‡¨§ ‡¨ú‡¨£‡≠á ‡¨™‡≠ç‡¨∞‡¨´‡≠á‡¨∏‡¨®‡¨æ‡¨≤‡¨ô‡≠ç‡¨ï ‡¨∏‡¨π‡¨ø‡¨§ ‡¨™‡¨∞‡¨æ‡¨Æ‡¨∞‡≠ç‡¨∂ ‡¨ï‡¨∞‡¨®‡≠ç‡¨§‡≠Å‡•§</p>
            </div>`
        };

        // Event listeners
        window.addEventListener('load', () => {
            updateUIText(currentLanguage);
            highlightVoiceFeature();
        });
        sendBtn.addEventListener('click', processMessage);
        messageInput.addEventListener('keypress', handleKeyPress);
        document.querySelectorAll('.quick-btn').forEach(button => {
            button.addEventListener('click', () => {
                const query = button.getAttribute('data-query');
                messageInput.value = query;
                processMessage();
            });
        });
        voiceBtn.addEventListener('click', toggleVoiceInput);
        keyboardBtn.addEventListener('click', toggleKeyboard);
        closeTooltipBtn.addEventListener('click', hideVoiceTooltip);

        
        // Function to update all UI text based on the selected language
        function updateUIText(lang) {
            const langTranslations = translations[lang] || translations.en;
            initialMessageContainer.innerHTML = langTranslations.initialMessage;
            messageInput.placeholder = langTranslations.placeholder;
            searchingMessage.textContent = langTranslations.searching;
            tooltipText.textContent = langTranslations.voiceTooltip; // Update tooltip text
        }

        // Function to set the conversation language
        function setLanguage(lang) {
            currentLanguage = lang;
            document.querySelectorAll('.lang-btn').forEach(btn => btn.classList.remove('active'));
            document.getElementById(`lang-${lang}`).classList.add('active');
            
            // Clear chat and update UI to new language
            chatArea.innerHTML = '';
            const typingIndicator = `<div id="typingIndicator" class="typing-indicator flex items-center space-x-1 p-3 bg-white rounded-xl shadow-sm w-fit">
                <div class="w-2 h-2 bg-gray-400 rounded-full animate-pulse-delay-0"></div>
                <div class="w-2 h-2 bg-gray-400 rounded-full animate-pulse-delay-1"></div>
                <div class="w-2 h-2 bg-gray-400 rounded-full animate-pulse-delay-2"></div>
            </div>`;
            chatArea.innerHTML = `<div id="initialMessageContainer"></div>${typingIndicator}`;
            updateUIText(lang);

            addMessage(translations[lang].languageChanged, false);

            if (!virtualKeyboard.classList.contains('hidden')) {
                renderKeyboard();
            }
        }

        function addMessage(message, isUser = false) {
            const messageDiv = document.createElement('div');
            messageDiv.className = `message message-enter-active p-3 rounded-xl shadow-sm max-w-xs sm:max-w-md ${isUser ? 'user-message text-white ml-auto' : 'bot-message text-gray-800'}`;
            messageDiv.innerHTML = message;
            
            const typingIndicator = document.getElementById('typingIndicator');
            chatArea.insertBefore(messageDiv, typingIndicator);
            
            chatArea.scrollTop = chatArea.scrollHeight;
        }

        function handleKeyPress(event) {
            if (event.key === 'Enter') {
                processMessage();
            }
        }
        
        function showSearchingOverlay() {
            searchingMessage.textContent = translations[currentLanguage].searching;
            searchingOverlay.classList.remove('hidden');
        }

        function hideSearchingOverlay() {
            searchingOverlay.classList.add('hidden');
        }

        function isCritical(query) {
            const criticalKeywords = ['chest pain', 'severe pain', 'severe bleeding', 'breathing difficulty', 'difficulty breathing', 'unconscious', 'fainting', 'heart attack', 'stroke', '‡§õ‡§æ‡§§‡•Ä ‡§Æ‡•á‡§Ç ‡§¶‡§∞‡•ç‡§¶', '‡§ó‡§Ç‡§≠‡•Ä‡§∞ ‡§¶‡§∞‡•ç‡§¶', '‡§∏‡§æ‡§Ç‡§∏ ‡§≤‡•á‡§®‡•á ‡§Æ‡•á‡§Ç ‡§¶‡§ø‡§ï‡•ç‡§ï‡§§', '‡§§‡•á‡§ú ‡§¶‡§∞‡•ç‡§¶', '‡§∞‡§ï‡•ç‡§§‡§∏‡•ç‡§∞‡§æ‡§µ', '‡§Ö‡§ö‡•á‡§§', '‡§π‡•É‡§¶‡§Ø ‡§ò‡§æ‡§§', '‡§õ‡§æ‡§§‡•Ä', '‡¨π‡≠É‡¨¶‡¨ò‡¨æ‡¨§', '‡¨∏‡¨æ‡¨Ç‡¨ò‡¨æ‡¨§‡¨ø‡¨ï ‡¨Ø‡¨®‡≠ç‡¨§‡≠ç‡¨∞‡¨£‡¨æ', '‡¨∞‡¨ï‡≠ç‡¨§‡¨∏‡≠ç‡¨∞‡¨æ‡¨¨', '‡¨Ö‡¨ú‡≠ç‡¨û‡¨æ‡¨®', '‡¨õ‡¨æ‡¨§‡¨ø ‡¨Ø‡¨®‡≠ç‡¨§‡≠ç‡¨∞‡¨£‡¨æ', '‡¨®‡¨ø‡¨∂‡≠ç‡≠±‡¨æ‡¨∏ ‡¨®‡≠á‡¨¨‡¨æ‡¨∞‡≠á ‡¨Ö‡¨∏‡≠Å‡¨¨‡¨ø‡¨ß‡¨æ'];
            const lowerCaseQuery = query.toLowerCase();
            return criticalKeywords.some(keyword => lowerCaseQuery.includes(keyword));
        }

        async function processMessage() {
            const userMessage = messageInput.value.trim();
            if (userMessage === '') return;

            addMessage(userMessage, true);
            messageInput.value = '';
            virtualKeyboard.classList.add('hidden'); // Hide keyboard on send

            if (isCritical(userMessage)) {
                addMessage(criticalResponses[currentLanguage], false);
                return;
            }
            
            const lowerCaseUserMessage = userMessage.toLowerCase();
            
            if (knowledgeBase.womensHealth[currentLanguage]?.keywords.some(keyword => lowerCaseUserMessage.includes(keyword))) {
                 addMessage(knowledgeBase.womensHealth[currentLanguage].response, false);
                 return;
            }
            
            if (knowledgeBase.diseaseOutbreaks[currentLanguage]?.keywords.some(keyword => lowerCaseUserMessage.includes(keyword))) {
                await fetchGovtHealthAlerts();
                return;
            }

            const cityMatch = /(?:in|at|located in|located at)\s+([a-zA-Z\s]+)/i.exec(userMessage);
            const city = cityMatch ? cityMatch[1].trim().toLowerCase() : null;

            if (city && knowledgeBase.importantCityHospitals[city]) {
                addMessage(knowledgeBase.importantCityHospitals[city][currentLanguage] || knowledgeBase.importantCityHospitals[city].en, false);
                return;
            }
            
            if (knowledgeBase.govtHospitals[currentLanguage]?.keywords.some(keyword => lowerCaseUserMessage.includes(keyword))) {
                if (city) {
                    await handleHospitalSearch(city);
                } else {
                    addMessage(knowledgeBase.govtHospitals[currentLanguage].response, false);
                }
                return;
            }

            showSearchingOverlay();

            try {
                const payload = {
                    contents: [{ parts: [{ text: userMessage }] }],
                    tools: [{ "google_search": {} }],
                    systemInstruction: {
                        parts: [{
                            text: `You are Sushruta, a chill and reassuring AI Health Assistant. Your tone should be calm, relaxed, and not cause any panic. Reassure the user with phrases like "Don't worry," and focus on providing simple, actionable advice. Respond to user health queries in a point-based format. Your response must be grounded in real-time search results to ensure accuracy.
                            
                            When asked for a solution related to a health issue in India, search for official advisories and solutions from the Indian Ministry of Health and Family Welfare, National Health Mission, or other official Indian government health portals.

                            Please follow these formatting rules strictly:
                            1. Begin your response with a disclaimer that you are not a substitute for a professional medical doctor.
                            2. Provide a clear, easy-to-read list of symptoms.
                            3. Provide a clear, easy-to-read list of recommended precautions or solutions.
                            4. Use HTML strong tags (<strong></strong>) to bold and highlight important keywords.
                            5. Use HTML list tags (<ul><li>) for all lists.
                            6. Do not use asterisks or any other markdown for bullet points.
                            7. Do not over-concise the answer.
                            8. Respond in the language requested by the user. The user's preferred language is ${currentLanguage}.
                            9. Use relevant emojis where appropriate. üòä`
                        }]
                    },
                };
                
                const response = await fetch(API_URL, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(payload)
                });
                
                if (response.status === 401) {
                    console.error("API Error: 401 Unauthorized. Please ensure your API key is valid.");
                    addMessage("I'm sorry, I'm unable to connect. Please check the API key and try again.", false);
                    return;
                }

                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }

                const result = await response.json();
                const candidate = result?.candidates?.[0];

                if (candidate && candidate.content?.parts?.[0]?.text) {
                    const botResponseText = candidate.content.parts[0].text;
                    addMessage(botResponseText, false);

                } else {
                    addMessage("Sorry, I could not generate a response. Please try again.", false);
                }

            } catch (error) {
                console.error("General Error:", error);
                addMessage("I'm sorry, an unexpected error occurred. Please try again later.", false);
            } finally {
                hideSearchingOverlay();
            }
        }
        
        async function fetchGovtHealthAlerts() {
            showSearchingOverlay();
            await new Promise(resolve => setTimeout(resolve, 1500)); // Simulate API call
            const mockGovtData = {
                en: `üìÑ <strong>Health Advisory (as of Sep 10, 2025)</strong><br>
                Latest alerts from the Ministry of Health: üòä
                <ul>
                    <li><strong>Dengue & Chikungunya:</strong> Cases are rising. Protect yourself from mosquito bites.</li>
                    <li><strong>Viral Fever Watch (UP):</strong> Seasonal increase noted in Noida. Maintain hygiene.</li>
                    <li><strong>Seasonal Flu:</strong> Vaccination recommended for high-risk groups.</li>
                </ul>`,
                hi: `üìÑ <strong>‡§∏‡•ç‡§µ‡§æ‡§∏‡•ç‡§•‡•ç‡§Ø ‡§∏‡§≤‡§æ‡§π (10 ‡§∏‡§ø‡§§‡§Ç‡§¨‡§∞, 2025)</strong><br>
                ‡§∏‡•ç‡§µ‡§æ‡§∏‡•ç‡§•‡•ç‡§Ø ‡§Æ‡§Ç‡§§‡•ç‡§∞‡§æ‡§≤‡§Ø ‡§∏‡•á ‡§®‡§µ‡•Ä‡§®‡§§‡§Æ ‡§Ö‡§≤‡§∞‡•ç‡§ü: üòä
                <ul>
                    <li><strong>‡§°‡•á‡§Ç‡§ó‡•Ç ‡§î‡§∞ ‡§ö‡§ø‡§ï‡§®‡§ó‡•Å‡§®‡§ø‡§Ø‡§æ:</strong> ‡§Æ‡§æ‡§Æ‡§≤‡•á ‡§¨‡§¢‡§º ‡§∞‡§π‡•á ‡§π‡•à‡§Ç‡•§ ‡§Æ‡§ö‡•ç‡§õ‡§∞‡•ã‡§Ç ‡§ï‡•á ‡§ï‡§æ‡§ü‡§®‡•á ‡§∏‡•á ‡§ñ‡•Å‡§¶ ‡§ï‡•ã ‡§¨‡§ö‡§æ‡§è‡§Ç‡•§</li>
                    <li><strong>‡§µ‡§æ‡§Ø‡§∞‡§≤ ‡§´‡•Ä‡§µ‡§∞ ‡§µ‡•â‡§ö (‡§Ø‡•Ç‡§™‡•Ä):</strong> ‡§®‡•ã‡§è‡§°‡§æ ‡§Æ‡•á‡§Ç ‡§Æ‡•å‡§∏‡§Æ‡•Ä ‡§µ‡•É‡§¶‡•ç‡§ß‡§ø‡•§ ‡§∏‡•ç‡§µ‡§ö‡•ç‡§õ‡§§‡§æ ‡§¨‡§®‡§æ‡§è ‡§∞‡§ñ‡•á‡§Ç‡•§</li>
                    <li><strong>‡§Æ‡•å‡§∏‡§Æ‡•Ä ‡§´‡•ç‡§≤‡•Ç:</strong> ‡§â‡§ö‡•ç‡§ö ‡§ú‡•ã‡§ñ‡§ø‡§Æ ‡§µ‡§æ‡§≤‡•á ‡§∏‡§Æ‡•Ç‡§π‡•ã‡§Ç ‡§ï‡•á ‡§≤‡§ø‡§è ‡§ü‡•Ä‡§ï‡§æ‡§ï‡§∞‡§£ ‡§ï‡•Ä ‡§∏‡§ø‡§´‡§æ‡§∞‡§ø‡§∂ ‡§ï‡•Ä ‡§ú‡§æ‡§§‡•Ä ‡§π‡•à‡•§</li>
                </ul>`,
                od: `üìÑ <strong>‡¨∏‡≠ç‡≠±‡¨æ‡¨∏‡≠ç‡¨•‡≠ç‡≠ü ‡¨™‡¨∞‡¨æ‡¨Æ‡¨∞‡≠ç‡¨∂ (‡¨∏‡≠á‡¨™‡≠ç‡¨ü‡≠á‡¨Æ‡≠ç‡¨¨‡¨∞ 10, 2025)</strong><br>
                ‡¨∏‡≠ç‡≠±‡¨æ‡¨∏‡≠ç‡¨•‡≠ç‡≠ü ‡¨Æ‡¨®‡≠ç‡¨§‡≠ç‡¨∞‡¨£‡¨æ‡¨≥‡≠ü‡¨∞‡≠Å ‡¨∏‡¨∞‡≠ç‡¨¨‡¨∂‡≠á‡¨∑ ‡¨∏‡¨§‡¨∞‡≠ç‡¨ï‡¨§‡¨æ: üòä
                <ul>
                    <li><strong>‡¨°‡≠á‡¨ô‡≠ç‡¨ó‡≠Å ‡¨è‡¨¨‡¨Ç ‡¨ö‡¨ø‡¨ï‡¨®‡¨ó‡≠Å‡¨®‡¨ø‡¨Ü:</strong> ‡¨Æ‡¨æ‡¨Æ‡¨≤‡¨æ ‡¨¨‡¨¢‡≠Å‡¨õ‡¨ø‡•§ ‡¨®‡¨ø‡¨ú‡¨ï‡≠Å ‡¨Æ‡¨∂‡¨æ ‡¨ï‡¨æ‡¨Æ‡≠Å‡¨°‡¨º‡¨æ‡¨∞‡≠Å ‡¨∞‡¨ï‡≠ç‡¨∑‡¨æ ‡¨ï‡¨∞‡¨®‡≠ç‡¨§‡≠Å‡•§</li>
                    <li><strong>‡¨≠‡¨æ‡¨á‡¨∞‡¨æ‡¨≤‡≠ç ‡¨ú‡≠ç‡≠±‡¨∞ (UP):</strong> ‡¨®‡≠ã‡¨è‡¨°‡¨æ‡¨∞‡≠á ‡¨Æ‡≠å‡¨∏‡≠Å‡¨Æ‡≠Ä ‡¨¨‡≠É‡¨¶‡≠ç‡¨ß‡¨ø‡•§ ‡¨∏‡≠ç‡≠±‡¨ö‡≠ç‡¨õ‡¨§‡¨æ ‡¨¨‡¨ú‡¨æ‡≠ü ‡¨∞‡¨ñ‡¨®‡≠ç‡¨§‡≠Å‡•§</li>
                    <li><strong>‡¨Æ‡≠å‡¨∏‡≠Å‡¨Æ‡≠Ä ‡¨´‡≠ç‡¨≤‡≠Å:</strong> ‡¨â‡¨ö‡≠ç‡¨ö-‡¨¨‡¨ø‡¨™‡¨¶ ‡¨•‡¨ø‡¨¨‡¨æ ‡¨ó‡≠ã‡¨∑‡≠ç‡¨†‡≠Ä‡¨ô‡≠ç‡¨ï ‡¨™‡¨æ‡¨á‡¨Å ‡¨ü‡≠Ä‡¨ï‡¨æ‡¨ï‡¨∞‡¨£ ‡¨∏‡≠Å‡¨™‡¨æ‡¨∞‡¨ø‡¨∂ ‡¨ï‡¨∞‡¨æ‡¨Ø‡¨æ‡¨è‡•§</li>
                </ul>`
            };
            addMessage(mockGovtData[currentLanguage] || mockGovtData.en, false);
            hideSearchingOverlay();
        }

        async function handleHospitalSearch(city) {
            showSearchingOverlay();
             await new Promise(resolve => setTimeout(resolve, 1000)); // Simulate API call
             const cityData = knowledgeBase.importantCityHospitals[city.toLowerCase()];
             if(cityData){
                 addMessage(cityData[currentLanguage] || cityData.en, false);
             } else {
                 addMessage(`I'm sorry, I couldn't find a list of government hospitals in ${city}. Please try searching with a different city name.`, false);
             }
            hideSearchingOverlay();
        }

        const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;
        let recognition;
        let isListening = false;

        if (SpeechRecognition) {
            recognition = new SpeechRecognition();
            recognition.continuous = false;
            recognition.interimResults = false;
            recognition.lang = getVoiceLanguage(currentLanguage);

            recognition.onstart = () => { isListening = true; micIcon.classList.add('voice-icon', 'listening'); };
            recognition.onend = () => { isListening = false; micIcon.classList.remove('voice-icon', 'listening'); };
            recognition.onresult = (event) => { messageInput.value = event.results[0][0].transcript; sendBtn.click(); };
            recognition.onerror = (event) => { console.error("Speech Recognition Error:", event.error); isListening = false; micIcon.classList.remove('voice-icon', 'listening'); };
        } else {
            voiceBtn.style.display = 'none';
        }

        function toggleVoiceInput() {
            if(!recognition) return;
            if (isListening) {
                recognition.stop();
            } else {
                recognition.lang = getVoiceLanguage(currentLanguage);
                recognition.start();
            }
        }
        
        function getVoiceLanguage(lang) {
            const voiceMap = { 'en': 'en-IN', 'hi': 'hi-IN', 'bn': 'bn-IN', 'ta': 'ta-IN', 'od': 'or-IN' };
            return voiceMap[lang] || 'en-IN';
        }

        const keyboardLayouts = {
            en: ["q", "w", "e", "r", "t", "y", "u", "i", "o", "p", "a", "s", "d", "f", "g", "h", "j", "k", "l", "z", "x", "c", "v", "b", "n", "m", " ", "‚Üê"],
            hi: ["‡§ï", "‡§ñ", "‡§ó", "‡§ò", "‡§ô", "‡§ö", "‡§õ", "‡§ú", "‡§ù", "‡§û", "‡§ü", "‡§†", "‡§°", "‡§¢", "‡§£", "‡§§", "‡§•", "‡§¶", "‡§ß", "‡§®", "‡§™", "‡§´", "‡§¨", "‡§≠", "‡§Æ", "‡§Ø", "‡§∞", "‡§≤", "‡§µ", "‡§∂", "‡§∑", "‡§∏", "‡§π", " ", "‚Üê"],
            bn: ["‡¶ï", "‡¶ñ", "‡¶ó", "‡¶ò", "‡¶ô", "‡¶ö", "‡¶õ", "‡¶ú", "‡¶ù", "‡¶û", "‡¶ü", "‡¶†", "‡¶°", "‡¶¢", "‡¶£", "‡¶§", "‡¶•", "‡¶¶", "‡¶ß", "‡¶®", "‡¶™", "‡¶´", "‡¶¨", "‡¶≠", "‡¶Æ", "‡¶Ø", "‡¶∞", "‡¶≤", "‡¶¨", "‡¶∂", "‡¶∑", "‡¶∏", "‡¶π", " ", "‚Üê"],
            ta: ["‡Æï", "‡Æô", "‡Æö", "‡Æû", "‡Æü", "‡Æ£", "‡Æ§", "‡Æ®", "‡Æ™", "‡ÆÆ", "‡ÆØ", "‡Æ∞", "‡Æ≤", "‡Æµ", "‡Æ¥", "‡Æ≥", "‡Æ±", "‡Æ©", "‡Æú", "‡Æ∑", "‡Æ∏", "‡Æπ", "‡Æï‡Øç‡Æ∑", "‡Æ∏‡Øç‡Æ∞‡ØÄ", " ", "‚Üê"],
            od: ["‡¨ï", "‡¨ñ", "‡¨ó", "‡¨ò", "‡¨ô", "‡¨ö", "‡¨õ", "‡¨ú", "‡¨ù", "‡¨û", "‡¨ü", "‡¨†", "‡¨°", "‡¨¢", "‡¨£", "‡¨§", "‡¨•", "‡¨¶", "‡¨ß", "‡¨®", "‡¨™", "‡¨´", "‡¨¨", "‡¨≠", "‡¨Æ", "‡¨Ø", "‡¨∞", "‡¨≤", "‡¨µ", "‡¨∂", "‡¨∑", "‡¨∏", "‡¨π", " ", "‚Üê"]
        };
        
        function renderKeyboard() {
            keyboardLayout.innerHTML = '';
            const layout = keyboardLayouts[currentLanguage] || keyboardLayouts.en;
            const keysPerRow = 10;
            keyboardLayout.style.gridTemplateColumns = `repeat(${keysPerRow}, 1fr)`;
            
            layout.forEach(key => {
                const button = document.createElement('button');
                button.textContent = key;
                button.className = 'bg-white hover:bg-gray-100 text-gray-800 p-2 rounded-md text-base font-semibold transition';
                if (key === '‚Üê') {
                    button.onclick = () => messageInput.value = messageInput.value.slice(0, -1);
                } else if (key === ' ') {
                    button.onclick = () => messageInput.value += ' ';
                    button.classList.add('col-span-4'); // Make space bar wider
                } else {
                    button.onclick = () => messageInput.value += key;
                }
                keyboardLayout.appendChild(button);
            });
        }
        
        function toggleKeyboard() {
            virtualKeyboard.classList.toggle('hidden');
            if (!virtualKeyboard.classList.contains('hidden')) {
                renderKeyboard();
            }
        }

        function highlightVoiceFeature() {
            if(window.innerWidth > 640) { // Only show on desktop
                voiceTooltip.classList.remove('hidden');
                setTimeout(() => { 
                     voiceTooltip.classList.remove('opacity-0');
                     voiceTooltip.classList.add('opacity-100');
                }, 10);
                voiceBtn.classList.add('voice-btn-highlight');
                setTimeout(hideVoiceTooltip, 10000);
            }
        }

        function hideVoiceTooltip() {
            voiceTooltip.classList.remove('opacity-100');
            voiceTooltip.classList.add('opacity-0');
            voiceBtn.classList.remove('voice-btn-highlight');
            setTimeout(() => {
                voiceTooltip.classList.add('hidden');
            }, 300);
        }
    </script>
</body>
</html>

